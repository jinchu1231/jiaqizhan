{"remainingRequest":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js??vue-loader-options!/Users/交安/gas/vue/gas-web/src/views/system/menu/components/dataAuthorize/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/交安/gas/vue/gas-web/src/views/system/menu/components/dataAuthorize/index.vue","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/babel.config.js","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime@7.24.5@@babel/runtime/helpers/interopRequireDefault.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _authorize = require(\"@/api/system/authorize\");\nvar _dataAuthorize = require(\"@/api/system/dataAuthorize\");\nvar _menu = require(\"@/api/system/menu\");\nvar _dataSource = require(\"@/api/systemData/dataSource\");\nvar _DataSchemeForm = _interopRequireDefault(require(\"./DataSchemeForm\"));\nvar _DataAuthorizeForm = _interopRequireDefault(require(\"./DataAuthorizeForm\"));\nvar _connectForm = _interopRequireDefault(require(\"../connectForm\"));\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = exports.default = {\n  components: {\n    DataSchemeForm: _DataSchemeForm.default,\n    DataAuthorizeForm: _DataAuthorizeForm.default,\n    DataConnectForm: _connectForm.default\n  },\n  data: function data() {\n    return {\n      tabActiveName: \"dataAuthorizeScheme\",\n      dataAuthorizeListDrawer: false,\n      dialogTitle: \"\",\n      moduleId: \"\",\n      loading: false,\n      btnLoading: false,\n      listLoading: false,\n      dataListLoading: false,\n      dataAuthorizeSchemeList: [],\n      dataAuthorizeList: [],\n      dataSchemeFormVisible: false,\n      dataAuthorizeFormVisible: false,\n      dataConnectFormVisible: false,\n      menuType: 2,\n      dbOptions: [],\n      dbList: [],\n      tableName: \"\",\n      dataType: \"\",\n      dataList: []\n    };\n  },\n  methods: {\n    init: function init(moduleId, fullName, type, dataType) {\n      var _this = this;\n      this.menuType = type;\n      this.dataType = dataType;\n      this.dataAuthorizeListDrawer = true;\n      this.moduleId = moduleId;\n      this.tabActiveName = \"dataAuthorizeScheme\";\n      this.dialogTitle = \"\\u6570\\u636E\\u6743\\u9650 - \".concat(fullName);\n      this.dbList = [];\n      this.dbOptions = [];\n      this.$nextTick(function () {\n        if (_this.$refs[\"DataConnectForm\"]) {\n          _this.$refs[\"DataConnectForm\"].dataForm.dataSelect = \"\";\n        }\n        _this.listLoading = true;\n        _this.dataListLoading = true;\n        _this.getAuthorizeSchemeList();\n      });\n      if (this.menuType === 3) {\n        // getFieldNameList(this.moduleId, \"DataAuthorize\").then(res => {\n        //   this.dbList = res.data || [];\n        // });\n      }\n    },\n    getConnectList: function getConnectList(tableName) {\n      this.tableName = tableName || \"\";\n      this.getInfo();\n    },\n    getAuthorizeSchemeList: function getAuthorizeSchemeList() {\n      var _this2 = this;\n      // 获取方案管理列表\n      (0, _dataAuthorize.getDataAuthorizeSchemeList)(this.moduleId).then(function (res) {\n        _this2.dataAuthorizeSchemeList = res.data.list;\n        _this2.listLoading = false;\n        _this2.btnLoading = false;\n      }).catch(function () {\n        _this2.listLoading = false;\n        _this2.btnLoading = false;\n      });\n    },\n    getAuthorizeList: function getAuthorizeList() {\n      var _this3 = this;\n      // 获取字段列表\n      (0, _dataAuthorize.getDataAuthorizeList)(this.moduleId).then(function (res) {\n        _this3.dataAuthorizeList = res.data.list;\n        _this3.dataListLoading = false;\n        _this3.btnLoading = false;\n      }).catch(function () {\n        _this3.dataListLoading = false;\n        _this3.btnLoading = false;\n      });\n    },\n    handleClick: function handleClick() {\n      this.btnLoading = false;\n      var activeTab = this.tabActiveName;\n      if (activeTab === \"dataAuthorizeScheme\") {\n        this.getAuthorizeSchemeList();\n      } else {\n        this.getAuthorizeList();\n        if (this.menuType === 2) {\n          this.getDataSourceListAll();\n          this.getInfo();\n        }\n      }\n    },\n    handleReLoad: function handleReLoad() {\n      this.btnLoading = true;\n      var activeTab = this.tabActiveName;\n      if (activeTab === \"dataAuthorizeScheme\") {\n        this.getAuthorizeSchemeList();\n      } else {\n        this.getAuthorizeList();\n      }\n    },\n    getInfo: function getInfo() {\n      var _this4 = this;\n      (0, _authorize.getInfo)(this.moduleId, this.dataType).then(function (res) {\n        _this4.dataList = res.data || {};\n        _this4.tableName = _this4.dataList.linkTables || '';\n      });\n    },\n    getDataSourceListAll: function getDataSourceListAll() {\n      var _this5 = this;\n      (0, _dataSource.getDataSourceListAll)().then(function (res) {\n        var list = res.data.list || [];\n        _this5.dbOptions = list.filter(function (o) {\n          return o.children && o.children.length;\n        });\n      });\n    },\n    //数据连接\n    addDataConnect: function addDataConnect() {\n      var _this6 = this;\n      this.dataConnectFormVisible = true;\n      this.$nextTick(function () {\n        _this6.$refs.DataConnectForm.init(_this6.dataList, _this6.moduleId, _this6.dbOptions, _this6.dataType);\n      });\n    },\n    //新增,编辑\n    addOrUpdateHandle: function addOrUpdateHandle(id) {\n      var _this7 = this;\n      var activeTab = this.tabActiveName;\n      if (activeTab === \"dataAuthorizeScheme\") {\n        this.dataSchemeFormVisible = true;\n        this.$nextTick(function () {\n          _this7.$refs.DataSchemeForm.init(_this7.moduleId, id);\n        });\n      } else {\n        this.dataAuthorizeFormVisible = true;\n        this.$nextTick(function () {\n          _this7.$refs.DataAuthorizeForm.init(_this7.moduleId, id, _this7.menuType, _this7.dataType);\n        });\n      }\n    },\n    addHandle: function addHandle() {\n      var _this8 = this;\n      var isAllData = this.dataAuthorizeSchemeList.filter(function (o) {\n        return o.enCode === \"jnpf_alldata\";\n      });\n      if (!!isAllData.length) return this.$message({\n        message: \"该方案已新增，不可重复添加\",\n        type: \"error\",\n        duration: 1500\n      });\n      if (this.tabActiveName === \"dataAuthorizeScheme\") {\n        var data = {\n          moduleId: this.moduleId,\n          enCode: \"jnpf_alldata\",\n          fullName: \"全部数据\",\n          allData: 1\n        };\n        (0, _dataAuthorize.createDataScheme)(data).then(function (res) {\n          _this8.$message({\n            message: res.msg,\n            type: \"success\",\n            duration: 1500,\n            onClose: function onClose() {\n              _this8.btnLoading = false;\n            }\n          });\n          _this8.getAuthorizeSchemeList();\n        }).catch(function () {\n          _this8.btnLoading = false;\n        });\n      }\n    },\n    handleDel: function handleDel(id) {\n      var _this9 = this;\n      this.$confirm(this.$t(\"common.delTip\"), this.$t(\"common.tipTitle\"), {\n        type: \"warning\"\n      }).then(function () {\n        var delMethod = _this9.tabActiveName === \"dataAuthorizeScheme\" ? _dataAuthorize.delDataScheme : _dataAuthorize.delDataAuthorize;\n        delMethod(id).then(function (res) {\n          _this9.$message({\n            type: \"success\",\n            message: res.msg,\n            duration: 1500,\n            onClose: function onClose() {\n              _this9.handleReLoad();\n            }\n          });\n        });\n      }).catch(function () {});\n    }\n  }\n};",null]}