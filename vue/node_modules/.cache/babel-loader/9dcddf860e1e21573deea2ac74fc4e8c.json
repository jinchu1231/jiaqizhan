{"remainingRequest":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js??vue-loader-options!/Users/交安/gas/vue/gas-web/src/views/system/sysConfig/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/交安/gas/vue/gas-web/src/views/system/sysConfig/index.vue","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/babel.config.js","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime@7.24.5@@babel/runtime/helpers/interopRequireDefault.js\");\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\nrequire(\"core-js/modules/web.dom.iterable\");\nrequire(\"core-js/modules/es6.object.keys\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _defineProperty2 = _interopRequireDefault(require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime-corejs2@7.24.5@@babel/runtime-corejs2/helpers/defineProperty.js\"));\nvar _sysConfig = require(\"@/api/system/sysConfig\");\nvar _SingleImg = _interopRequireDefault(require(\"@/components/Upload/SingleImg\"));\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; } //\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = exports.default = {\n  name: 'system-sysConfig',\n  components: {\n    singleImg: _SingleImg.default\n  },\n  data: function data() {\n    return {\n      activeName: 'first',\n      listLoading: false,\n      btnLoading: false,\n      testQyLoading: false,\n      testSyncLoading: false,\n      testDingLoading: false,\n      wechatLoading: false,\n      dingLoading: false,\n      thirdTab: '1',\n      secondTab: '0',\n      visible: false,\n      synchronization: '',\n      name: '',\n      names: '',\n      row: '',\n      baseForm: {\n        title: '',\n        sysName: '',\n        sysDescription: '',\n        sysVersion: '',\n        loginIcon: '',\n        logoIcon: '',\n        appIcon: '',\n        copyright: '',\n        companyName: '',\n        companyCode: '',\n        companyAddress: '',\n        companyContacts: '',\n        companyTelePhone: '',\n        companyEmail: '',\n        singleLogin: '1',\n        tokenTimeout: '1',\n        lastLoginTimeSwitch: 1,\n        whitelistSwitch: 1,\n        whiteListIp: '',\n        qyhCorpId: '',\n        qyhAgentId: '',\n        qyhAgentSecret: '',\n        qyhCorpSecret: '',\n        qyhIsSynOrg: 0,\n        qyhIsSynUser: 0,\n        dingSynAppKey: '',\n        dingSynAppSecret: '',\n        dingAgentId: '',\n        dingSynIsSynOrg: 0,\n        dingSynIsSynUser: 0,\n        passwordErrorsNumber: 0,\n        lockType: 1,\n        lockTime: 10,\n        enableVerificationCode: 0,\n        passwordIsUpdatedRegularly: 0,\n        updateCycle: 0,\n        updateInAdvance: 0,\n        passwordStrengthLimit: 0,\n        passwordLengthMin: false,\n        passwordLengthMinNumber: 0,\n        containsNumbers: false,\n        includeLowercaseLetters: false,\n        includeUppercaseLetters: false,\n        containsCharacters: false,\n        disableOldPassword: 0,\n        disableTheNumberOfOldPasswords: 0,\n        mandatoryModificationOfInitialPassword: 0,\n        linkTime: 24,\n        isClick: 0,\n        unClickNum: 1\n      },\n      rules: {},\n      wxEvents: [{\n        select: false,\n        title: '启用同步组织',\n        desc: '新增、删除、修改组织信息触发同步组织事件'\n      }, {\n        select: false,\n        title: '启用同步用户',\n        desc: '新增、删除、修改用户信息触发同步用户事件'\n      }],\n      wxResults: [{\n        recordTotal: '',\n        synDate: '',\n        synFailCount: '',\n        synSuccessCount: '',\n        synType: '组织',\n        unSynCount: ''\n      }, {\n        recordTotal: '',\n        synDate: '',\n        synFailCount: '',\n        synSuccessCount: '',\n        synType: '用户',\n        unSynCount: ''\n      }],\n      ddEvents: [{\n        select: false,\n        title: '启用同步组织',\n        desc: '新增、删除、修改组织信息触发同步组织事件'\n      }, {\n        select: false,\n        title: '启用同步用户',\n        desc: '新增、删除、修改用户信息触发同步用户事件'\n      }],\n      ddResults: [{\n        recordTotal: '',\n        synDate: '',\n        synFailCount: '',\n        synSuccessCount: '',\n        synType: '组织',\n        unSynCount: ''\n      }, {\n        recordTotal: '',\n        synDate: '',\n        synFailCount: '',\n        synSuccessCount: '',\n        synType: '用户',\n        unSynCount: ''\n      }],\n      adminIds: []\n    };\n  },\n  watch: {\n    thirdTab: {\n      handler: function handler(val) {\n        this.getSynThirdTotal(val);\n      },\n      immediate: true\n    },\n    activeName: function activeName(val) {\n      if (val === 'fourth') {\n        this.getAdminList();\n      }\n    }\n  },\n  created: function created() {\n    this.activeName = this.$route.query.type == 1 ? 'third' : 'first';\n    this.initData();\n  },\n  methods: {\n    initConfig: function initConfig() {\n      if (!this.baseForm.disableTheNumberOfOldPasswords) this.baseForm.disableTheNumberOfOldPasswords = 1;\n      if (!this.baseForm.updateCycle) this.baseForm.updateCycle = 1;\n      if (!this.baseForm.updateInAdvance) this.baseForm.updateInAdvance = 1;\n      if (!this.baseForm.passwordLengthMinNumber) this.baseForm.passwordLengthMinNumber = 1;\n    },\n    initData: function initData() {\n      var _this = this;\n      this.listLoading = true;\n      this.$nextTick(function () {\n        (0, _sysConfig.getSystemConfig)().then(function (res) {\n          _this.baseForm = res.data;\n          _this.wxEvents[0].select = _this.baseForm.qyhIsSynOrg ? true : false;\n          _this.wxEvents[1].select = _this.baseForm.qyhIsSynUser ? true : false;\n          _this.ddEvents[0].select = _this.baseForm.dingSynIsSynOrg ? true : false;\n          _this.ddEvents[1].select = _this.baseForm.dingSynIsSynUser ? true : false;\n          _this.baseForm.smsCompany = _this.baseForm.smsCompany ? _this.baseForm.smsCompany : '1';\n          _this.baseForm.lockType = _this.baseForm.lockType ? _this.baseForm.lockType : 1;\n          _this.baseForm.lockTime = _this.baseForm.lockTime ? _this.baseForm.lockTime : 10;\n          _this.baseForm.isClick = _this.baseForm.isClick ? _this.baseForm.isClick : 0;\n          _this.baseForm.linkTime = _this.baseForm.linkTime ? _this.baseForm.linkTime : 24;\n          _this.baseForm.unClickNum = _this.baseForm.unClickNum ? _this.baseForm.unClickNum : 1;\n          _this.listLoading = false;\n        }).catch(function () {\n          _this.listLoading = false;\n        });\n      });\n    },\n    checkQy: function checkQy(type) {\n      var _this2 = this;\n      type === 1 ? this.testSyncLoading = true : this.testQyLoading = true;\n      var data = {\n        qyhAgentId: this.baseForm.qyhAgentId,\n        qyhAgentSecret: this.baseForm.qyhAgentSecret,\n        qyhCorpId: this.baseForm.qyhCorpId,\n        qyhCorpSecret: this.baseForm.qyhCorpSecret\n      };\n      (0, _sysConfig.testQy)(data, type).then(function (res) {\n        _this2.$message({\n          message: res.msg,\n          type: 'success',\n          duration: 1500,\n          onClose: function onClose() {\n            type === 1 ? _this2.testSyncLoading = false : _this2.testQyLoading = false;\n          }\n        });\n      }).catch(function () {\n        type === 1 ? _this2.testSyncLoading = false : _this2.testQyLoading = false;\n      });\n    },\n    checkDing: function checkDing() {\n      var _this3 = this;\n      this.testDingLoading = true;\n      var data = {\n        dingAgentId: this.baseForm.dingAgentId,\n        dingSynAppKey: this.baseForm.dingSynAppKey,\n        dingSynAppSecret: this.baseForm.dingSynAppSecret\n      };\n      (0, _sysConfig.testDing)(data).then(function (res) {\n        _this3.$message({\n          message: res.msg,\n          type: 'success',\n          duration: 1500,\n          onClose: function onClose() {\n            _this3.testDingLoading = false;\n          }\n        });\n      }).catch(function () {\n        _this3.testDingLoading = false;\n      });\n    },\n    getSynThirdTotal: function getSynThirdTotal(type) {\n      var _this4 = this;\n      (0, _sysConfig.getSynThirdTotal)(type).then(function (res) {\n        var list = res.data.map(function (o) {\n          return _objectSpread({\n            loading: false\n          }, o);\n        });\n        type == '1' ? _this4.wxResults = list : _this4.ddResults = list;\n      });\n    },\n    syncWechat: function syncWechat(row) {\n      this.name = '同步到企业微信';\n      this.names = '把系统数据同步到企业微信';\n      this.synchronization = '把企业微信数据同步到系统';\n      this.row = row || '';\n      this.visible = true;\n    },\n    syncDingVisible: function syncDingVisible(row) {\n      this.name = '同步到阿里钉钉';\n      this.names = '把系统数据同步到阿里钉钉';\n      this.synchronization = '把阿里钉钉数据同步到系统';\n      this.row = row || '';\n      this.visible = true;\n    },\n    syncQy: function syncQy(type) {\n      var _this5 = this;\n      this.$confirm('同步以后会丢失现有数据，是否继续？', '提示', {\n        type: 'warning'\n      }).then(function () {\n        type == 0 ? _this5.wechatLoading = true : _this5.dingLoading = true;\n        var method = _this5.row.synType == '组织' ? _sysConfig.synAllOrganizeSysToQy : _sysConfig.synAllUserSysToQy;\n        method(type).then(function (res) {\n          type == 0 ? _this5.wechatLoading = false : _this5.dingLoading = false;\n          _this5.visible = false;\n          if (res.msg === '正在进行同步,请稍等') {\n            _this5.$message({\n              message: res.msg,\n              type: 'success',\n              duration: 1500\n            });\n            return;\n          }\n          _this5.row.recordTotal = res.data.recordTotal;\n          _this5.row.synDate = res.data.synDate;\n          _this5.row.synFailCount = res.data.synFailCount;\n          _this5.row.synSuccessCount = res.data.synSuccessCount;\n          _this5.row.synType = res.data.synType;\n          _this5.row.unSynCount = res.data.unSynCount;\n          _this5.$message({\n            message: '同步成功',\n            type: 'success',\n            duration: 1500\n          });\n        }).catch(function () {\n          type == 0 ? _this5.wechatLoading = false : _this5.dingLoading = false;\n        });\n      });\n    },\n    syncDing: function syncDing(type) {\n      var _this6 = this;\n      this.$confirm('同步以后会丢失现有数据，是否继续？', '提示', {\n        type: 'warning'\n      }).then(function () {\n        type == 0 ? _this6.wechatLoading = true : _this6.dingLoading = true;\n        var method = _this6.row.synType == '组织' ? _sysConfig.synAllOrganizeSysToDing : _sysConfig.synAllUserSysToDing;\n        method(type).then(function (res) {\n          type == 0 ? _this6.wechatLoading = false : _this6.dingLoading = false;\n          _this6.visible = false;\n          if (res.msg === '正在进行同步,请稍等') {\n            _this6.$message({\n              message: res.msg,\n              type: 'success',\n              duration: 1500\n            });\n            return;\n          }\n          _this6.row.recordTotal = res.data.recordTotal;\n          _this6.row.synDate = res.data.synDate;\n          _this6.row.synFailCount = res.data.synFailCount;\n          _this6.row.synSuccessCount = res.data.synSuccessCount;\n          _this6.row.synType = res.data.synType;\n          _this6.row.unSynCount = res.data.unSynCount;\n          _this6.$message({\n            message: '同步成功',\n            type: 'success',\n            duration: 1500\n          });\n        }).catch(function () {\n          type == 0 ? _this6.wechatLoading = false : _this6.dingLoading = false;\n        });\n      });\n    },\n    submitSmsForm: function submitSmsForm() {\n      var _this7 = this;\n      this.$refs['baseForm'].validate(function (valid) {\n        if (!valid) return;\n        _this7.submitForm();\n      });\n    },\n    submitForm: function submitForm() {\n      var _this8 = this;\n      this.baseForm.qyhIsSynOrg = this.wxEvents[0].select ? 1 : 0;\n      this.baseForm.qyhIsSynUser = this.wxEvents[1].select ? 1 : 0;\n      this.baseForm.dingSynIsSynOrg = this.ddEvents[0].select ? 1 : 0;\n      this.baseForm.dingSynIsSynUser = this.ddEvents[1].select ? 1 : 0;\n      this.baseForm.passwordLengthMin = this.baseForm.passwordLengthMin ? 1 : 0;\n      this.baseForm.containsNumbers = this.baseForm.containsNumbers ? 1 : 0;\n      this.baseForm.includeLowercaseLetters = this.baseForm.includeLowercaseLetters ? 1 : 0;\n      this.baseForm.includeUppercaseLetters = this.baseForm.includeUppercaseLetters ? 1 : 0;\n      this.baseForm.containsCharacters = this.baseForm.containsCharacters ? 1 : 0;\n      this.$confirm('您确定要保存，是否继续？', '提示', {\n        type: 'warning'\n      }).then(function () {\n        _this8.btnLoading = true;\n        (0, _sysConfig.updateSystemConfig)(_this8.baseForm).then(function (res) {\n          _this8.$message({\n            message: res.msg,\n            type: 'success',\n            duration: 1500,\n            onClose: function onClose() {\n              _this8.btnLoading = false;\n              var sysConfig = {\n                sysName: _this8.baseForm.sysName,\n                sysVersion: _this8.baseForm.sysVersion,\n                loginIcon: _this8.baseForm.loginIcon,\n                copyright: _this8.baseForm.copyright,\n                companyName: _this8.baseForm.companyName,\n                logoIcon: _this8.baseForm.logoIcon,\n                appIcon: _this8.baseForm.appIcon,\n                title: _this8.baseForm.title\n              };\n              _this8.$store.commit('settings/CHANGE_SETTING', {\n                key: \"sysConfig\",\n                value: sysConfig\n              });\n              _this8.initData();\n            }\n          });\n        }).catch(function () {\n          _this8.btnLoading = false;\n        });\n      }).catch(function () {\n        _this8.btnLoading = false;\n      });\n    },\n    getAdminList: function getAdminList() {\n      var _this9 = this;\n      (0, _sysConfig.getAdminList)().then(function (res) {\n        if (!res.data) return;\n        _this9.adminIds = res.data.map(function (o) {\n          return o.id;\n        });\n      });\n    },\n    setAdminList: function setAdminList() {\n      var _this10 = this;\n      this.btnLoading = true;\n      this.$confirm('您确定要保存，是否继续？', '提示', {\n        type: 'warning'\n      }).then(function () {\n        (0, _sysConfig.setAdminList)(_this10.adminIds).then(function (res) {\n          _this10.$message({\n            message: res.msg,\n            type: 'success',\n            duration: 1500,\n            onClose: function onClose() {\n              _this10.btnLoading = false;\n            }\n          });\n        });\n      }).catch(function () {\n        _this10.btnLoading = false;\n      });\n    }\n  }\n};",null]}