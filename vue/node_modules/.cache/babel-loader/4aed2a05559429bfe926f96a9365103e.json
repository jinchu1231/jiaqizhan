{"remainingRequest":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js??vue-loader-options!/Users/交安/gas/vue/gas-web/src/views/system/menu/components/columnAuthorize/Form.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/交安/gas/vue/gas-web/src/views/system/menu/components/columnAuthorize/Form.vue","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/babel.config.js","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime@7.24.5@@babel/runtime/helpers/interopRequireDefault.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/web.dom.iterable\");\nvar _columnAuthorize = require(\"@/api/system/columnAuthorize\");\nvar _NameSelect = _interopRequireDefault(require(\"../NameSelect.vue\"));\nvar _authorize = require(\"@/api/system/authorize\");\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = exports.default = {\n  components: {\n    nameSelects: _NameSelect.default\n  },\n  data: function data() {\n    return {\n      nameVisible: false,\n      visible: false,\n      formLoading: false,\n      btnLoading: false,\n      dataForm: {\n        id: \"\",\n        moduleId: \"\",\n        bindTable: \"\",\n        bindTableName: \"\",\n        fullName: \"\",\n        enCode: \"\",\n        sortCode: 0,\n        enabledMark: 1,\n        description: \"\",\n        fieldRule: 0,\n        childTableKey: ''\n      },\n      treeData: [],\n      menuType: '',\n      dataType: \"\",\n      enCodeOptions: [],\n      fieldRuleOptions: [{\n        value: 0,\n        label: \"主表规则\"\n      }, {\n        value: 1,\n        label: \"副表规则\"\n      }, {\n        value: 2,\n        label: \"子表规则\"\n      }],\n      dataRule: {\n        enCode: [{\n          required: true,\n          message: \"字段名称不能为空\",\n          trigger: \"change\"\n        }],\n        childTableKey: [{\n          required: true,\n          message: \"关联字段不能为空\",\n          trigger: \"blur\"\n        }],\n        fullName: [{\n          required: true,\n          message: \"字段说明不能为空\",\n          trigger: \"blur\"\n        }],\n        fieldRule: [{\n          required: true,\n          message: \"字段规则不能为空\",\n          trigger: \"change\"\n        }]\n      }\n    };\n  },\n  methods: {\n    init: function init(moduleId, id, menuType, dataType) {\n      var _this = this;\n      this.menuType = menuType;\n      this.dataType = dataType;\n      this.dataForm.id = id || \"\";\n      this.dataForm.moduleId = moduleId;\n      this.visible = true;\n      this.formLoading = true;\n      this.treeData = [];\n      (0, _authorize.getVisualTables)(moduleId, dataType).then(function (res) {\n        var data = [];\n        for (var key in res.data.linkTables) {\n          data.push({\n            tableName: res.data.linkTables[key],\n            dbLink: res.data.linkId\n          });\n        }\n        _this.treeData = data;\n      });\n      this.$nextTick(function () {\n        _this.$refs[\"dataForm\"].resetFields();\n        _this.dataForm.bindTable = '';\n        _this.dataForm.fieldRule = 0;\n        // 获取字段数据\n        if (_this.dataForm.id) {\n          (0, _columnAuthorize.getColumnInfo)(_this.dataForm.id).then(function (res) {\n            _this.dataForm = res.data;\n          });\n        }\n        _this.formLoading = false;\n      });\n    },\n    selectName: function selectName() {\n      var _this2 = this;\n      this.nameVisible = true;\n      this.$nextTick(function () {\n        _this2.$refs.nameForm.openDialog();\n      });\n    },\n    changeFieldRule: function changeFieldRule() {\n      this.dataForm.childTableKey = '';\n    },\n    closeForm: function closeForm(val, value) {\n      this.dataForm.enCode = val;\n      if (value.tableName) this.dataForm.bindTable = value.tableName;\n      if (value.fieldName) this.dataForm.fullName = value.fieldName;\n    },\n    onEnCodeChange: function onEnCodeChange(e) {\n      var objVal;\n      this.dataForm.fullName = \"\";\n      this.dataForm.type = \"\";\n      if (!!e) {\n        this.enCodeOptions.forEach(function (o) {\n          if (o.field === e) {\n            objVal = {\n              fullName: o.fieldName,\n              type: o.dataType\n            };\n            return objVal;\n          }\n        });\n        this.dataForm.fullName = objVal[\"fullName\"];\n        this.dataForm.type = objVal[\"type\"];\n      }\n    },\n    dataFormSubmit: function dataFormSubmit() {\n      var _this3 = this;\n      this.$refs[\"dataForm\"].validate(function (valid) {\n        if (valid) {\n          _this3.btnLoading = true;\n          var formMethod = _this3.dataForm.id ? _columnAuthorize.updateColumn : _columnAuthorize.createColumn;\n          formMethod(_this3.dataForm).then(function (res) {\n            _this3.$message({\n              message: res.msg,\n              type: \"success\",\n              duration: 1500,\n              onClose: function onClose() {\n                _this3.visible = false;\n                _this3.btnLoading = false;\n                _this3.$emit(\"refreshDataList\");\n              }\n            });\n          }).catch(function () {\n            _this3.btnLoading = false;\n          });\n        }\n      });\n    }\n  }\n};",null]}