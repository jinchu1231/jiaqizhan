{"remainingRequest":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js??vue-loader-options!/Users/交安/gas/vue/gas-web/src/components/Generator/index/Home.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/交安/gas/vue/gas-web/src/components/Generator/index/Home.vue","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/babel.config.js","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime@7.24.5@@babel/runtime/helpers/interopRequireDefault.js\");\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es6.array.find-index\");\nrequire(\"core-js/modules/es6.object.keys\");\nrequire(\"core-js/modules/web.dom.iterable\");\nvar _defineProperty2 = _interopRequireDefault(require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime-corejs2@7.24.5@@babel/runtime-corejs2/helpers/defineProperty.js\"));\nrequire(\"core-js/modules/es7.array.includes\");\nrequire(\"core-js/modules/es6.string.includes\");\nvar _toConsumableArray2 = _interopRequireDefault(require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime-corejs2@7.24.5@@babel/runtime-corejs2/helpers/toConsumableArray.js\"));\nvar _typeof2 = _interopRequireDefault(require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime-corejs2@7.24.5@@babel/runtime-corejs2/helpers/typeof.js\"));\nvar _vuedraggable = _interopRequireDefault(require(\"vuedraggable\"));\nvar _throttleDebounce = require(\"throttle-debounce\");\nvar _render = _interopRequireDefault(require(\"@/components/Generator/render/render\"));\nvar _JsonDrawer = _interopRequireDefault(require(\"./JsonDrawer\"));\nvar _RightPanel = _interopRequireDefault(require(\"./RightPanel\"));\nvar _preview = _interopRequireDefault(require(\"../preview\"));\nvar _config = require(\"@/components/Generator/generator/config\");\nvar _comConfig = require(\"@/components/Generator/generator/comConfig\");\nvar _utils = require(\"@/components/Generator/utils\");\nvar _drawingDefalut = _interopRequireDefault(require(\"@/components/Generator/generator/drawingDefalut\"));\nvar _DraggableItem = _interopRequireDefault(require(\"./DraggableItem\"));\nvar _DraggableItemApp = _interopRequireDefault(require(\"./DraggableItemApp\"));\nvar _db = require(\"@/components/Generator/utils/db\");\nvar _validate = require(\"@/utils/validate\");\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; } //\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar emptyActiveData = {\n  style: {},\n  autosize: {}\n};\nvar oldActiveId;\nvar tempActiveData;\nvar idGlobal = (0, _db.getIdGlobal)();\nvar _default = exports.default = {\n  components: {\n    draggable: _vuedraggable.default,\n    render: _render.default,\n    JsonDrawer: _JsonDrawer.default,\n    RightPanel: _RightPanel.default,\n    DraggableItem: _DraggableItem.default,\n    DraggableItemApp: _DraggableItemApp.default,\n    Preview: _preview.default\n  },\n  props: ['conf', 'modelType', 'webType', 'dbType', 'formInfo'],\n  data: function data() {\n    return {\n      idGlobal: 100,\n      formConf: (0, _utils.deepClone)(_config.formConf),\n      inputComponents: _config.inputComponents,\n      selectComponents: _config.selectComponents,\n      systemComponents: _config.systemComponents,\n      layoutComponents: _config.layoutComponents,\n      labelWidth: 100,\n      drawingList: [],\n      drawingData: {},\n      activeId: null,\n      drawerVisible: false,\n      previewVisible: false,\n      formData: {},\n      dialogVisible: false,\n      jsonDrawerVisible: false,\n      generateConf: null,\n      showFileName: false,\n      activeData: {},\n      saveDrawingListDebounce: (0, _throttleDebounce.debounce)(340, _db.saveDrawingList),\n      saveIdGlobalDebounce: (0, _throttleDebounce.debounce)(340, _db.saveIdGlobal),\n      isDrawingListChange: true,\n      showTip: true,\n      activeItem: {},\n      activeTableItem: {},\n      showType: 'pc',\n      leftComponents: [{\n        title: '基础控件',\n        list: _config.inputComponents\n      }, {\n        title: '高级控件',\n        list: _config.selectComponents\n      }, {\n        title: '系统控件',\n        list: _config.systemComponents\n      }, {\n        title: '布局控件',\n        list: _config.layoutComponents\n      }],\n      rowIndex: 0,\n      colIndex: 0,\n      rowData: [],\n      colData: [],\n      selectCell: {\n        __config__: {\n          rowspan: 1,\n          colspan: 1\n        }\n      }\n    };\n  },\n  provide: function provide() {\n    var _this = this;\n    return {\n      getShowType: function getShowType() {\n        return _this.showType;\n      }\n    };\n  },\n  computed: {\n    mergeLeftColDisabled: function mergeLeftColDisabled() {\n      if (!this.colData.length) return true;\n      return this.colIndex <= 0 || this.colData[this.colIndex - 1].__config__.rowspan !== this.selectCell.__config__.rowspan;\n    },\n    mergeRightColDisabled: function mergeRightColDisabled() {\n      if (!this.colData.length) return true;\n      var rightColIndex = this.colIndex + this.selectCell.__config__.colspan;\n      return this.colIndex >= this.colData.length - 1 || rightColIndex > this.colData.length - 1 || this.colData[rightColIndex].__config__.rowspan !== this.selectCell.__config__.rowspan;\n    },\n    mergeWholeRowDisabled: function mergeWholeRowDisabled() {\n      if (!this.selectCell.__config__ || !this.rowData.length) return true;\n      var rowDataChildren = this.rowData[this.rowIndex].__config__.children;\n      var startRowspan = rowDataChildren[0].__config__.rowspan;\n      var unmatchedFlag = false;\n      for (var i = 1; i < rowDataChildren.length; i++) {\n        if (rowDataChildren[i].__config__.rowspan !== startRowspan) {\n          unmatchedFlag = true;\n          break;\n        }\n      }\n      if (unmatchedFlag) return true;\n      return this.colData.length <= 1 || this.colData.length === this.selectCell.__config__.colspan;\n    },\n    mergeAboveRowDisabled: function mergeAboveRowDisabled() {\n      if (!this.rowData.length || this.rowIndex <= 0) return true;\n      return this.rowData[this.rowIndex - 1].__config__.children[this.colIndex].__config__.colspan !== this.selectCell.__config__.colspan || this.rowData[this.rowIndex - 1].__config__.children[this.colIndex].__config__.merged;\n    },\n    mergeBelowRowDisabled: function mergeBelowRowDisabled() {\n      if (!this.rowData.length || this.rowIndex == this.rowData.length) return true;\n      var belowRowIndex = this.rowIndex + this.selectCell.__config__.rowspan;\n      return this.rowIndex >= this.rowData.length - 1 || belowRowIndex > this.rowData.length - 1 || this.rowData[belowRowIndex].__config__.children[this.colIndex].__config__.colspan !== this.selectCell.__config__.colspan || this.rowData[belowRowIndex].__config__.children[this.colIndex].__config__.merged;\n    },\n    mergeWholeColDisabled: function mergeWholeColDisabled() {\n      if (!this.rowData.length) return true;\n      var startColspan = this.rowData[0].__config__.children[this.colIndex].__config__.colspan;\n      var unmatchedFlag = false;\n      for (var i = 1; i < this.rowData.length; i++) {\n        if (this.rowData[i].__config__.children[this.colIndex].__config__.colspan !== startColspan) {\n          unmatchedFlag = true;\n          break;\n        }\n      }\n      if (unmatchedFlag) return true;\n      return this.rowData.length <= 1 || this.rowData.length === this.selectCell.__config__.rowspan;\n    },\n    undoMergeRowDisabled: function undoMergeRowDisabled() {\n      return this.selectCell.__config__.merged || this.selectCell.__config__.colspan <= 1;\n    },\n    undoMergeColDisabled: function undoMergeColDisabled() {\n      return this.selectCell.__config__.merged || this.selectCell.__config__.rowspan <= 1;\n    },\n    deleteWholeColDisabled: function deleteWholeColDisabled() {\n      if (!this.rowData.length) return true;\n      if (this.rowData[0].__config__.children[0].__config__.colspan === this.rowData[0].__config__.children.length) return true;\n      var startColspan = this.rowData[0].__config__.children[this.colIndex].__config__.colspan;\n      var unmatchedFlag = false;\n      for (var i = 1; i < this.rowData.length; i++) {\n        if (this.rowData[i].__config__.children[this.colIndex].__config__.colspan !== startColspan) {\n          unmatchedFlag = true;\n          break;\n        }\n      }\n      if (unmatchedFlag) return true;\n      return this.selectCell.__config__.colspan === this.colData.length;\n    },\n    deleteWholeRowDisabled: function deleteWholeRowDisabled() {\n      if (!this.rowData.length || this.rowData.length <= this.rowIndex) return true;\n      if (this.rowData[0].__config__.children[0].__config__.rowspan === this.rowData.length) return true;\n      //整行所有单元格行高不一致不可删除！！\n      var startRowspan = this.rowData[this.rowIndex].__config__.children[0].__config__.rowspan;\n      var unmatchedFlag = false;\n      for (var i = 1; i < this.rowData[this.rowIndex].__config__.children.length; i++) {\n        if (this.rowData[this.rowIndex].__config__.children[i].__config__.rowspan !== startRowspan) {\n          unmatchedFlag = true;\n          break;\n        }\n      }\n      if (unmatchedFlag) return true;\n      return this.rowData.length === 1 || this.selectCell.__config__.rowspan === this.rowData.length;\n    },\n    getFormInfo: function getFormInfo() {\n      return this.formInfo || {};\n    }\n  },\n  watch: {\n    // eslint-disable-next-line func-names\n    'activeData.__config__.label': function activeData__config__Label(val, oldVal) {\n      // if (\n      //   this.activeData.placeholder === undefined\n      //   || !this.activeData.__config__.tag\n      //   || oldActiveId !== this.activeId\n      // ) {\n      //   return\n      // }\n      // this.activeData.placeholder = this.activeData.placeholder.replace(oldVal, '') + val\n    },\n    activeId: {\n      handler: function handler(val) {\n        oldActiveId = val;\n      },\n      immediate: true\n    },\n    drawingList: {\n      handler: function handler(val) {\n        this.saveDrawingListDebounce(val);\n        if (val.length === 0) {\n          this.idGlobal = 100;\n          this.activeData = {};\n        }\n        // if (!this.isDrawingListChange) {\n        //   this.isDrawingListChange = true\n        //   return\n        // }\n        this.$emit('drawingListChange');\n      },\n      deep: true\n    },\n    idGlobal: {\n      handler: function handler(val) {\n        this.formConf.idGlobal = val;\n        // this.saveIdGlobalDebounce(val)\n      },\n      immediate: true\n    }\n  },\n  created: function created() {\n    if ((0, _typeof2.default)(this.conf) === 'object' && this.conf !== null) {\n      this.isDrawingListChange = false;\n      this.drawingList = (0, _utils.deepClone)(this.conf.fields);\n      Object.assign(this.formConf, this.conf);\n      this.idGlobal = this.formConf.idGlobal;\n      if (this.drawingList.length) this.activeFormItem(this.drawingList[0]);\n    } else {\n      this.drawingList = [];\n      this.idGlobal = 100;\n    }\n    if (this.modelType == 1 || this.modelType == 6) {\n      this.leftComponents[1].list = [].concat((0, _toConsumableArray2.default)(this.leftComponents[1].list), [_comConfig.calculateItem]);\n      this.leftComponents[0].list = [].concat((0, _toConsumableArray2.default)(this.leftComponents[0].list), (0, _toConsumableArray2.default)(_comConfig.onlinePeculiarList));\n    }\n    if (this.webType != 2 || this.modelType == 3 || this.modelType == 6) this.formConf.popupType = 'fullScreen';\n  },\n  mounted: function mounted() {\n    // fix: firefox 下 拖拽 会新打卡一个选项卡\n    // https://github.com/JakHuang/form-generator/issues/15\n    document.body.ondrop = function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n    };\n  },\n  methods: {\n    // 供父组件使用 获取表单JSON\n    getData: function getData() {\n      var _this2 = this;\n      return new Promise(function (resolve, reject) {\n        if (!_this2.drawingList.length) {\n          reject({\n            msg: '表单不允许为空',\n            target: 1\n          });\n          return;\n        }\n        var loop = function loop(list) {\n          for (var i = 0; i < list.length; i++) {\n            var e = list[i];\n            var config = e.__config__;\n            if (config.layout === \"colFormItem\" && !_comConfig.noVModelList.includes(config.jnpfKey) && !e.__vModel__) {\n              reject({\n                msg: \"\".concat(config.label, \"\\u7684\\u63A7\\u4EF6\\u5B57\\u6BB5\\u4E0D\\u80FD\\u4E3A\\u7A7A\"),\n                target: 1\n              });\n              break;\n            }\n            if (e.isStorage == 1 && !e.__vModel__) {\n              reject({\n                msg: \"\".concat(config.label, \"\\u7684\\u63A7\\u4EF6\\u5B57\\u6BB5\\u4E0D\\u80FD\\u4E3A\\u7A7A\"),\n                target: 1\n              });\n              break;\n            }\n            if (config.jnpfKey === 'billRule') {\n              if (!config.rule) {\n                reject({\n                  msg: '单据组件“单据模板”属性为必填项',\n                  target: 1\n                });\n                break;\n              }\n            }\n            if (config.jnpfKey === 'relationForm') {\n              if (!e.modelId) {\n                reject({\n                  msg: '关联表单控件“关联功能”属性为必填项',\n                  target: 1\n                });\n                break;\n              }\n              if (!e.relationField) {\n                reject({\n                  msg: '关联表单控件“显示字段”属性为必填项',\n                  target: 1\n                });\n                break;\n              }\n            }\n            if (config.jnpfKey === 'popupSelect') {\n              if (!e.interfaceId) {\n                reject({\n                  msg: '弹窗选择控件“远端数据”属性为必填项',\n                  target: 1\n                });\n                break;\n              }\n              if (!e.propsValue) {\n                reject({\n                  msg: '弹窗选择控件“储存字段”属性为必填项',\n                  target: 1\n                });\n                break;\n              }\n              if (!e.relationField) {\n                reject({\n                  msg: '弹窗选择控件“显示字段”属性为必填项',\n                  target: 1\n                });\n                break;\n              }\n            }\n            if (config.jnpfKey === 'popupTableSelect') {\n              if (!e.interfaceId) {\n                reject({\n                  msg: '下拉表格控件“远端数据”属性为必填项',\n                  target: 1\n                });\n                break;\n              }\n              if (!e.propsValue) {\n                reject({\n                  msg: '下拉表格控件“储存字段”属性为必填项',\n                  target: 1\n                });\n                break;\n              }\n              if (!e.relationField) {\n                reject({\n                  msg: '下拉表格控件“显示字段”属性为必填项',\n                  target: 1\n                });\n                break;\n              }\n            }\n            if (config.jnpfKey === 'autoComplete') {\n              if (!e.interfaceId) {\n                reject({\n                  msg: '下拉补全控件“远端数据”属性为必填项',\n                  target: 1\n                });\n                break;\n              }\n              if (!e.relationField) {\n                reject({\n                  msg: '下拉补全控件“显示字段”属性为必填项',\n                  target: 1\n                });\n                break;\n              }\n            }\n            if (config.layout === 'rowFormItem' && !config.children.length) {\n              reject({\n                msg: \"\\u60A8\\u7684\".concat(config.label, \"\\u63A7\\u4EF6\\u4E2D\\u6CA1\\u6709\\u7EC4\\u4EF6\"),\n                target: 1\n              });\n              break;\n            }\n            if (config && config.children && Array.isArray(config.children)) {\n              loop(config.children);\n            }\n            if (config.jnpfKey === 'uploadFile') {\n              if (e.pathType === 'selfPath') {\n                if (e.isAccount === 0) {\n                  if (!e.folder) {\n                    reject({\n                      msg: '请设置自定义路径',\n                      target: 1\n                    });\n                    break;\n                  }\n                }\n              }\n            }\n            if (config.jnpfKey === 'uploadImg') {\n              if (e.pathType === 'selfPath') {\n                if (e.isAccount === 0) {\n                  if (!e.folder) {\n                    reject({\n                      msg: '请设置自定义路径',\n                      target: 1\n                    });\n                    break;\n                  }\n                }\n              }\n            }\n            if (config.jnpfKey === 'link') {\n              if (e.href && !(0, _validate.validURL)(e.href)) {\n                reject({\n                  msg: '请输入正确的链接地址',\n                  target: 1\n                });\n                break;\n              }\n            }\n          }\n        };\n        loop(_this2.drawingList);\n        _this2.AssembleFormData();\n        if (_this2.formData.hasPrintBtn && (!_this2.formData.printId || !_this2.formData.printId.length)) {\n          reject({\n            msg: \"\\u8BF7\\u9009\\u62E9\\u6253\\u5370\\u6A21\\u677F\",\n            target: 1\n          });\n        }\n        resolve({\n          formData: _this2.formData,\n          target: 1\n        });\n      });\n    },\n    //  阻止表格中嵌套行容器\n    shouldClone: function shouldClone(to, from, target, event, conf) {\n      var targetConf = target._underlying_vm_;\n      var isRowContainer = conf.__config__.cmpType === 'common' && conf.__config__.jnpfKey === 'row';\n      if (isRowContainer) return true;\n      if (conf.cmpType === 'custom') return false;\n      if (conf.__config__.jnpfKey === 'table') {\n        if (_comConfig.noTableAllowList.includes(targetConf.__config__.jnpfKey)) {\n          // if (this.showTip) {\n          //   this.$message.warning(`子表内暂不支持使用该组件`)\n          //   this.showTip = false\n          // }\n          return false;\n        }\n        if (targetConf.__config__.layout === 'rowFormItem') return false;\n        if (this.$store.getters.hasTable) {\n          if (!conf.__config__.tableName) {\n            if (this.showTip) {\n              this.$message.warning(\"\\u5B50\\u8868\\u8BF7\\u5148\\u5173\\u8054\\u6570\\u636E\\u8868\");\n              this.showTip = false;\n            }\n            return false;\n          }\n        }\n        this.activeItem = targetConf;\n        this.activeTableItem = conf;\n      }\n      if (conf.__config__.jnpfKey === 'tableGridTd' && targetConf.__config__.jnpfKey === 'tableGrid') return false;\n      return true;\n    },\n    activeFormItem: function activeFormItem(element) {\n      this.activeData = element;\n      this.activeId = element.__config__.formId;\n    },\n    onEnd: function onEnd(obj) {\n      this.showTip = true;\n      if (obj.from !== obj.to) {\n        this.activeData = tempActiveData;\n        this.activeId = tempActiveData.__config__.formId;\n      }\n      if (obj.to.className.indexOf('table-wrapper') > -1) {\n        this.$set(this.activeItem.__config__, 'isSubTable', true);\n        this.$set(this.activeItem.__config__, 'parentVModel', this.activeTableItem.__vModel__);\n        if (this.$store.getters.hasTable) {\n          this.$set(this.activeItem.__config__, 'relationTable', this.activeTableItem.__config__.tableName);\n          this.activeItem.__vModel__ = '';\n        }\n      }\n    },\n    onCenterEnd: function onCenterEnd(obj) {\n      this.showTip = true;\n      if (obj.from == obj.to) return;\n      if (obj.to.className.indexOf('table-wrapper') > -1) {\n        this.$set(this.activeItem.__config__, 'isSubTable', true);\n        this.$set(this.activeItem.__config__, 'parentVModel', this.activeTableItem.__vModel__);\n        if (this.$store.getters.hasTable) {\n          this.$set(this.activeItem.__config__, 'relationTable', this.activeTableItem.__config__.tableName);\n          this.activeItem.__vModel__ = '';\n        }\n      }\n    },\n    onTableEnd: function onTableEnd(obj, target, conf) {\n      if (obj.from == obj.to) return;\n      if (obj.to.className.indexOf('table-wrapper') < 0) {\n        this.$set(this.activeItem.__config__, 'isSubTable', false);\n        this.$set(this.activeItem.__config__, 'parentVModel', '');\n        if (this.$store.getters.hasTable) this.activeItem.__vModel__ = '';\n      } else {\n        this.$set(this.activeItem.__config__, 'isSubTable', true);\n        this.$set(this.activeItem.__config__, 'parentVModel', this.activeTableItem.__vModel__);\n        if (this.$store.getters.hasTable) {\n          this.$set(this.activeItem.__config__, 'relationTable', this.activeTableItem.__config__.tableName);\n          this.activeItem.__vModel__ = '';\n        }\n      }\n    },\n    addComponent: function addComponent(item) {\n      if (item.__config__.dragDisabled) return;\n      var clone = this.cloneComponent(item);\n      this.drawingList.push(clone);\n      this.activeFormItem(clone);\n    },\n    cloneComponent: function cloneComponent(origin) {\n      var clone = (0, _utils.deepClone)(origin);\n      var config = clone.__config__;\n      config.span = this.formConf.span; // 生成代码时，会根据span做精简判断\n      this.createIdAndKey(clone);\n      // clone.placeholder !== undefined && (clone.placeholder += config.label)\n      tempActiveData = clone;\n      return tempActiveData;\n    },\n    createIdAndKey: function createIdAndKey(item, parent) {\n      var _this3 = this;\n      var config = item.__config__;\n      config.formId = ++this.idGlobal;\n      config.renderKey = +new Date(); // 改变renderKey后可以实现强制更新组件\n      if (config.layout === 'colFormItem') {\n        if (!this.$store.getters.hasTable) {\n          // 分割线和按钮不加vModel\n          if (_comConfig.noVModelList.indexOf(config.jnpfKey) < 0 || item.isStorage == 1) {\n            item.__vModel__ = this.toggleVmodelCase(\"\".concat(config.jnpfKey, \"Field\").concat(this.idGlobal));\n          }\n        } else {\n          if (_comConfig.noVModelList.indexOf(config.jnpfKey) < 0 || item.isStorage == 1) {\n            item.__vModel__ = \"\";\n          }\n        }\n        if (parent && parent.__vModel__ && parent.__config__.jnpfKey === 'table') {\n          item.__config__.parentVModel = parent.__vModel__;\n        }\n      } else if (config.layout === 'rowFormItem') {\n        if (config.jnpfKey === 'table') {\n          item.__vModel__ = this.toggleVmodelCase(\"\".concat(config.jnpfKey, \"Field\").concat(this.idGlobal));\n        }\n        config.componentName = \"row\".concat(this.idGlobal);\n        !Array.isArray(config.children) && (config.children = []);\n        // delete config.label // rowFormItem无需配置label属性\n      }\n      if (Array.isArray(config.children)) {\n        config.children = config.children.map(function (childItem) {\n          return _this3.createIdAndKey(childItem, item);\n        });\n      }\n      return item;\n    },\n    setVModel: function setVModel(item) {\n      var config = item.__config__;\n      item.__vModel__ = this.toggleVmodelCase(\"\".concat(config.jnpfKey, \"Field\").concat(config.formId));\n    },\n    toggleVmodelCase: function toggleVmodelCase(str) {\n      var dbType = this.dbType || '';\n      if (dbType.toLowerCase() === 'Oracle'.toLowerCase() || dbType.toLowerCase() === 'DM'.toLowerCase()) {\n        return str.toUpperCase();\n      }\n      if (dbType.toLowerCase() === 'PostgreSQL'.toLowerCase() || dbType.toLowerCase() === 'KingBaseES'.toLowerCase()) {\n        return str.toLowerCase();\n      }\n      return str;\n    },\n    AssembleFormData: function AssembleFormData() {\n      this.formData = _objectSpread(_objectSpread({}, this.formConf), {}, {\n        fields: (0, _utils.deepClone)(this.drawingList)\n      });\n    },\n    empty: function empty() {\n      var _this4 = this;\n      this.$confirm('确定要清空所有组件吗？', '提示', {\n        type: 'warning'\n      }).then(function () {\n        _this4.drawingList = [];\n        _this4.idGlobal = 100;\n      }).catch(function () {});\n    },\n    drawingItemCopy: function drawingItemCopy(item, parent) {\n      var isActiveFormItem = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      var clone = (0, _utils.deepClone)(item);\n      clone = this.createIdAndKey(clone);\n      parent.push(clone);\n      isActiveFormItem && this.activeFormItem(clone);\n    },\n    drawingItemDelete: function drawingItemDelete(index, parent) {\n      var _this5 = this;\n      parent.splice(index, 1);\n      this.$nextTick(function () {\n        var len = _this5.drawingList.length;\n        if (len) {\n          _this5.activeFormItem(_this5.drawingList[len - 1]);\n        }\n      });\n    },\n    preview: function preview() {\n      this.AssembleFormData();\n      this.previewVisible = true;\n    },\n    showJson: function showJson() {\n      this.AssembleFormData();\n      this.jsonDrawerVisible = true;\n    },\n    tagChange: function tagChange(newTag) {\n      var _this6 = this;\n      newTag = this.cloneComponent(newTag);\n      var config = newTag.__config__;\n      newTag.__vModel__ = this.activeData.__vModel__;\n      config.formId = this.activeId;\n      config.span = this.activeData.__config__.span;\n      this.activeData.__config__.tag = config.tag;\n      this.activeData.__config__.tagIcon = config.tagIcon;\n      this.activeData.__config__.document = config.document;\n      if ((0, _typeof2.default)(this.activeData.__config__.defaultValue) === (0, _typeof2.default)(config.defaultValue)) {\n        config.defaultValue = this.activeData.__config__.defaultValue;\n      }\n      Object.keys(newTag).forEach(function (key) {\n        if (_this6.activeData[key] !== undefined) {\n          newTag[key] = _this6.activeData[key];\n        }\n      });\n      this.activeData = newTag;\n      this.updateDrawingList(newTag, this.drawingList);\n    },\n    updateDrawingList: function updateDrawingList(newTag, list) {\n      var _this7 = this;\n      var index = list.findIndex(function (item) {\n        return item.__config__.formId === _this7.activeId;\n      });\n      if (index > -1) {\n        list.splice(index, 1, newTag);\n      } else {\n        list.forEach(function (item) {\n          if (Array.isArray(item.__config__.children)) _this7.updateDrawingList(newTag, item.__config__.children);\n        });\n      }\n    },\n    refreshJson: function refreshJson(data) {\n      this.drawingList = (0, _utils.deepClone)(data.fields);\n      delete data.fields;\n      this.formConf = data;\n    },\n    relationChange: function relationChange(vmodel) {\n      var loop = function loop(list) {\n        for (var i = 0; i < list.length; i++) {\n          var config = list[i].__config__;\n          if (list[i].relationField && list[i].relationField === list[i].__vModel__) {\n            list[i].showField = '';\n          }\n          if (config && config.children && Array.isArray(config.children)) {\n            loop(config.children);\n          }\n        }\n      };\n      loop(this.drawingList);\n    },\n    handleTableAddRow: function handleTableAddRow(element, insertPos, cloneRowIdx) {\n      var _this8 = this;\n      var row = element.__config__.children;\n      var rowIdx = insertPos === undefined ? row.length : insertPos + row[cloneRowIdx].__config__.children[this.colIndex].__config__.rowspan - 1;\n      var newRow = cloneRowIdx === undefined ? (0, _utils.deepClone)(row[row.length - 1]) : (0, _utils.deepClone)(row[cloneRowIdx]);\n      newRow.__config__.children.forEach(function (col) {\n        col.__config__.formId = ++_this8.idGlobal;\n        col.__config__.merged = false;\n        col.__config__.colspan = 1;\n        col.__config__.rowspan = 1;\n        col.__config__.children = [];\n      });\n      newRow.__config__.formId = ++this.idGlobal;\n      newRow.__config__.jnpfKey = \"tableGridTr\";\n      row.splice(rowIdx, 0, newRow);\n    },\n    handleTableAddCol: function handleTableAddCol(element, insertPos, cloneRowIdx) {\n      var _this9 = this;\n      var row = element.__config__.children;\n      var colIdx = insertPos === undefined ? row[0].__config__.children.length : insertPos; //确定插入列位置\n      row.forEach(function (item) {\n        var newCol = {\n          __config__: {\n            jnpfKey: \"tableGridTd\",\n            merged: false,\n            colspan: 1,\n            rowspan: 1,\n            formId: ++_this9.idGlobal,\n            children: [],\n            backgroundColor: ''\n          }\n        };\n        item.__config__.children.splice(colIdx, 0, newCol);\n      });\n    },\n    mergeTableCol: function mergeTableCol(element, type) {\n      var mergedColIndex = type == 1 ? this.colIndex : this.colIndex + this.colData[this.colIndex].__config__.colspan;\n      var remainedColIndex = type == 1 ? this.colIndex - this.colData[this.colIndex - 1].__config__.colspan : this.colIndex;\n      var colChildren = this.colData[mergedColIndex].__config__.children;\n      var colChildren_ = this.colData[remainedColIndex].__config__.children;\n      this.colData[remainedColIndex].__config__.children = [].concat((0, _toConsumableArray2.default)(colChildren_), (0, _toConsumableArray2.default)((0, _utils.deepClone)(colChildren)));\n      var newColspan = this.colData[mergedColIndex].__config__.colspan * 1 + this.colData[remainedColIndex].__config__.colspan * 1;\n      this.setPropsOfMergedCols(remainedColIndex, newColspan, this.selectCell.__config__.rowspan);\n    },\n    mergeWholeCol: function mergeWholeCol() {\n      var _this10 = this;\n      var childrenData = this.colData.filter(function (colItem) {\n        return !colItem.merged && colItem.__config__.children && colItem.__config__.children.length;\n      });\n      if (childrenData && childrenData.length) {\n        childrenData.map(function (o, i) {\n          var _this10$colData$0$__c;\n          if (i == 0) _this10.colData[0].__config__.children = cloneDeep(o.__config__.children);\n          if (i != 0) (_this10$colData$0$__c = _this10.colData[0].__config__.children).push.apply(_this10$colData$0$__c, (0, _toConsumableArray2.default)((0, _utils.deepClone)(o.__config__.children)));\n        });\n      }\n      this.setPropsOfMergedCols(0, this.colData.length, this.colData[this.colIndex].__config__.rowspan);\n    },\n    mergeTableRow: function mergeTableRow(type) {\n      var mergedRowIndex = type == 1 ? this.rowIndex : this.rowIndex + this.selectCell.__config__.rowspan;\n      var remainedRowIndex = type == 1 ? this.rowIndex - 1 : this.rowIndex;\n      var childrenData = this.rowData[mergedRowIndex].__config__.children[this.colIndex].__config__.children;\n      var childrenData_ = this.rowData[remainedRowIndex].__config__.children[this.colIndex].__config__.children;\n      this.rowData[remainedRowIndex].__config__.children[this.colIndex].__config__.children = [].concat((0, _toConsumableArray2.default)(childrenData_), (0, _toConsumableArray2.default)((0, _utils.deepClone)(childrenData)));\n      var newRowspan = this.rowData[mergedRowIndex].__config__.children[this.colIndex].__config__.rowspan * 1 + this.rowData[remainedRowIndex].__config__.children[this.colIndex].__config__.rowspan * 1;\n      this.setPropsOfMergedRows(remainedRowIndex, this.selectCell.__config__.colspan, newRowspan);\n    },\n    mergeWholeRow: function mergeWholeRow() {\n      var _this11 = this;\n      var childrenData = [];\n      this.rowData.forEach(function (o) {\n        var tempCell = o.__config__.children[_this11.colIndex];\n        if (!o.__config__.merged && !!o.__config__.children && o.__config__.children.length) {\n          childrenData.push(tempCell);\n        }\n      });\n      var firstCellOfCol = this.rowData[0].__config__.children[this.colIndex];\n      if (childrenData && childrenData.length) {\n        childrenData.map(function (o, i) {\n          var _firstCellOfCol$__con;\n          if (i != 0) (_firstCellOfCol$__con = firstCellOfCol.__config__.children).push.apply(_firstCellOfCol$__con, (0, _toConsumableArray2.default)((0, _utils.deepClone)(o.__config__.children)));\n        });\n      }\n      this.setPropsOfMergedRows(0, firstCellOfCol.__config__.colspan, this.rowData.length);\n    },\n    undoMergeCol: function undoMergeCol() {\n      this.setPropsOfSplitCol(this.colIndex, this.selectCell.__config__.colspan, this.selectCell.__config__.rowspan);\n    },\n    undoMergeRow: function undoMergeRow() {\n      this.setPropsOfSplitRow(this.colIndex, this.selectCell.__config__.colspan, this.selectCell.__config__.rowspan);\n    },\n    deleteWholeCol: function deleteWholeCol() {\n      var _this12 = this;\n      var startColspan = this.rowData[0].__config__.children[this.colIndex].__config__.colspan;\n      this.rowData.forEach(function (rItem) {\n        rItem.__config__.children.splice(_this12.colIndex, startColspan);\n      });\n    },\n    deleteWholeRow: function deleteWholeRow() {\n      var startRowspan = this.rowData[this.rowIndex].__config__.children[0].__config__.rowspan;\n      this.rowData.splice(this.rowIndex, startRowspan);\n    },\n    setPropsOfMergedCols: function setPropsOfMergedCols(startColIndex, newColspan, rowspan) {\n      for (var i = this.rowIndex; i < this.rowIndex + rowspan; i++) {\n        for (var j = startColIndex; j < startColIndex + newColspan; j++) {\n          if (i === this.rowIndex && j === startColIndex) {\n            this.rowData[i].__config__.children[j].__config__.colspan = newColspan;\n            continue;\n          }\n          this.rowData[i].__config__.children[j].__config__.merged = true;\n          this.rowData[i].__config__.children[j].__config__.colspan = newColspan;\n          this.rowData[i].__config__.children[j].__config__.children = [];\n        }\n      }\n    },\n    setPropsOfMergedRows: function setPropsOfMergedRows(startRowIndex, colspan, newRowspan, colIndex) {\n      if (!colIndex) colIndex = this.colIndex;\n      for (var i = startRowIndex; i < startRowIndex + newRowspan; i++) {\n        for (var j = colIndex; j < colIndex + colspan; j++) {\n          if (i === startRowIndex && j === colIndex) {\n            this.rowData[i].__config__.children[j].__config__.rowspan = newRowspan;\n            continue;\n          }\n          this.rowData[i].__config__.children[j].__config__.merged = true;\n          this.rowData[i].__config__.children[j].__config__.rowspan = newRowspan;\n          this.rowData[i].__config__.children[j].__config__.children = [];\n        }\n      }\n    },\n    setPropsOfSplitCol: function setPropsOfSplitCol(startColIndex, colspan, rowspan) {\n      for (var i = this.rowIndex; i < this.rowIndex + rowspan; i++) {\n        for (var j = startColIndex; j < startColIndex + colspan; j++) {\n          this.rowData[i].__config__.children[j].__config__.merged = false;\n          this.rowData[i].__config__.children[j].__config__.rowspan = 1;\n          this.rowData[i].__config__.children[j].__config__.colspan = 1;\n        }\n      }\n    },\n    setPropsOfSplitRow: function setPropsOfSplitRow(startColIndex, colspan, rowspan) {\n      for (var i = this.rowIndex; i < this.rowIndex + rowspan; i++) {\n        for (var j = startColIndex; j < startColIndex + colspan; j++) {\n          this.rowData[i].__config__.children[j].__config__.merged = false;\n          this.rowData[i].__config__.children[j].__config__.rowspan = 1;\n          this.rowData[i].__config__.children[j].__config__.colspan = 1;\n        }\n      }\n    },\n    handleTableSetting: function handleTableSetting(e, element) {\n      switch (e) {\n        case '1':\n          //插入左侧列\n          this.handleTableAddCol(element, this.colIndex);\n          break;\n        case '2':\n          //插入右侧列\n          this.handleTableAddCol(element, this.colIndex + 1);\n          break;\n        case '3':\n          //插入上方行\n          this.handleTableAddRow(element, this.rowIndex, this.rowIndex);\n          break;\n        case '4':\n          //插入下方行\n          this.handleTableAddRow(element, this.rowIndex + 1, this.rowIndex);\n          break;\n        case '5':\n          //向左合并\n          this.mergeTableCol(element, 1);\n          break;\n        case '6':\n          //向右合并\n          this.mergeTableCol(element);\n          break;\n        case '7':\n          //合并整行\n          this.mergeWholeCol(element);\n          break;\n        case '8':\n          //向上合并\n          this.mergeTableRow(1);\n          break;\n        case '9':\n          //向下合并\n          this.mergeTableRow();\n          break;\n        case '10':\n          //合并整列\n          this.mergeWholeRow();\n          break;\n        case '11':\n          //撤销行合并\n          this.undoMergeCol();\n          break;\n        case '12':\n          //撤销列合并\n          this.undoMergeRow();\n          break;\n        case '13':\n          //删除整列\n          this.deleteWholeCol();\n          break;\n        case '14':\n          //删除整行\n          this.deleteWholeRow();\n          break;\n        default:\n          break;\n      }\n      this.resetData();\n    },\n    resetData: function resetData() {\n      this.rowIndex = 0, this.colIndex = 0, this.rowData = [], this.colData = [], this.selectCell = {\n        __config__: {\n          rowspan: 1,\n          colspan: 1\n        }\n      };\n    },\n    handleShowMenu: function handleShowMenu(element, rowIndex, colIndex) {\n      this.rowIndex = rowIndex;\n      this.colIndex = colIndex;\n      this.rowData = element.__config__.children;\n      this.colData = this.rowData[rowIndex].__config__.children;\n      this.selectCell = this.colData[colIndex];\n    }\n  }\n};",null]}