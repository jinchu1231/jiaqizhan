{"remainingRequest":"/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js??vue-loader-options!/Users/交安/gas/vue/gas-web/src/views/permission/organize/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/交安/gas/vue/gas-web/src/views/permission/organize/index.vue","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { getOrganizeList, delOrganize } from '@/api/permission/organize'\nimport Form from './Form'\nimport DepForm from './depForm'\nimport CheckUser from './checkUser'\nimport CheckPermissions from '@/components/CheckPermissions'\nexport default {\n  name: 'permission-organize',\n  components: { Form, DepForm, CheckUser, CheckPermissions },\n  data() {\n    return {\n      listQuery: {\n        keyword: '',\n        type: ''\n      },\n      treeList: [],\n      expands: true,\n      refreshTable: true,\n      btnLoading: false,\n      listLoading: true,\n      formVisible: false,\n      depFormVisible: false,\n      checkUserFormVisible: false,\n      checkPermissionsVisible: false,\n      options: [\n        { fullName: '公司', id: 'company' },\n        { fullName: '部门', id: 'department' },\n      ],\n    }\n  },\n  created() {\n    this.initData()\n  },\n  methods: {\n    initData() {\n      this.loading = true\n      getOrganizeList(this.listQuery).then(res => {\n        this.treeList = res.data.list\n        if (this.treeList.length > 0) this.setTableIndex(this.treeList);\n        this.listLoading = false\n        this.btnLoading = false\n      }).catch(() => {\n        this.listLoading = false\n        this.btnLoading = false\n      })\n    },\n    search() {\n      this.initData()\n    },\n    // 树形列表index层级，实现方法（可复制直接调用）\n    setTableIndex(arr, index) {\n      arr.forEach((item) => {\n        item.index = 1;\n        if (index) item.index = index + 1;\n        if (item.children) this.setTableIndex(item.children, item.index);\n      });\n    },\n    reset() {\n      this.listQuery.keyword = ''\n      this.listQuery.type = ''\n      this.initData()\n    },\n    addOrUpdateHandle(id, type, parentId) {\n      if (type === 'company') {\n        this.addOrUpdateOrganize(id, parentId)\n      } else {\n        this.addOrUpdateDep(id)\n      }\n    },\n    addOrUpdateOrganize(id, parentId) {\n      this.formVisible = true\n      this.$nextTick(() => {\n        this.$refs.Form.init(id, parentId)\n      })\n    },\n    addOrUpdateDep(id) {\n      this.depFormVisible = true\n      this.$nextTick(() => {\n        this.$refs.depForm.init(id)\n      })\n    },\n    closeForm(isRefresh) {\n      this.formVisible = false\n      if (isRefresh) {\n        this.keyword = ''\n        this.initData()\n      }\n    },\n    closeDepForm(isRefresh) {\n      this.depFormVisible = false\n      if (isRefresh) {\n        this.keyword = ''\n        this.initData()\n      }\n    },\n    checkMembers(id, name) {\n      this.checkUserFormVisible = true\n      this.$nextTick(() => {\n        this.$refs.checkUserForm.init(id, name)\n      })\n    },\n    checkPermissions(item) {\n      this.checkPermissionsVisible = true\n      this.$nextTick(() => {\n        this.$refs.checkPermissions.init(item, 2)\n      })\n    },\n    toggleExpand() {\n      this.refreshTable = false;\n      this.expands = !this.expands;\n      this.$nextTick(() => {\n        this.refreshTable = true;\n      });\n    },\n    handleDel(id) {\n      this.$confirm(this.$t('common.delTip'), this.$t('common.tipTitle'), {\n        type: 'warning'\n      }).then(() => {\n        delOrganize(id).then(res => {\n          this.$message({\n            type: 'success',\n            message: res.msg,\n            duration: 1500,\n            onClose: () => {\n              this.$store.commit('generator/SET_COMPANY_TREE', [])\n              this.$store.commit('generator/SET_DEP_TREE', [])\n              this.initData()\n            }\n          })\n        })\n      }).catch(() => { })\n    }\n  }\n}\n",null]}