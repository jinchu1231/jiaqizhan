{"remainingRequest":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js??vue-loader-options!/Users/交安/gas/vue/gas-web/src/components/JNPF-uploadBtn/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/交安/gas/vue/gas-web/src/components/JNPF-uploadBtn/index.vue","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/babel.config.js","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime@7.24.5@@babel/runtime/helpers/interopRequireDefault.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es6.function.name\");\nvar _slicedToArray2 = _interopRequireDefault(require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime-corejs2@7.24.5@@babel/runtime-corejs2/helpers/slicedToArray.js\"));\nrequire(\"core-js/modules/web.dom.iterable\");\nrequire(\"core-js/modules/es7.object.entries\");\nvar _common = require(\"@/api/common\");\nvar _menu = require(\"@/api/system/menu\");\nvar _dataReport = require(\"@/api/onlineDev/dataReport\");\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nvar hideList = ['/system/DataModel', '/system/DataInterfaceVariate'];\nvar _default2 = exports.default = {\n  name: 'JNPF-uploadBtn',\n  data: function data() {\n    return {\n      loading: false,\n      visible: false,\n      dataForm: {\n        type: 0,\n        fileList: [],\n        parentId: ''\n      },\n      rules: {\n        parentId: [{\n          required: true,\n          message: '上级菜单不能为空',\n          trigger: 'change'\n        }],\n        type: [{\n          required: true,\n          message: '请选择识别重复',\n          trigger: 'change',\n          type: 'number'\n        }],\n        fileList: [{\n          required: true,\n          message: '请上传文件',\n          trigger: 'change'\n        }]\n      },\n      treeOptions: []\n    };\n  },\n  props: {\n    url: {\n      type: String,\n      default: \"\"\n    },\n    buttonText: {\n      type: String,\n      default: '导入'\n    },\n    buttonType: {\n      type: String,\n      default: 'text'\n    },\n    data: {\n      type: Object,\n      default: function _default() {}\n    },\n    showIcon: {\n      type: Boolean,\n      default: true\n    },\n    accept: {\n      type: String,\n      default: '*'\n    },\n    type: {\n      type: String,\n      default: ''\n    },\n    importType: {\n      type: String,\n      default: ''\n    }\n  },\n  computed: {\n    getTipText: function getTipText() {\n      return \"\\u4E00\\u6B21\\u53EA\\u80FD\\u5BFC\\u5165\\u4E00\\u4E2A\\u6587\\u4EF6\\uFF0C\\u6587\\u4EF6\\u540E\\u7F00\\u540D\\u5FC5\\u987B\\u662F\".concat(this.accept, \"\\u3002\");\n    },\n    getIsHideType: function getIsHideType() {\n      var _this = this;\n      return hideList.some(function (o) {\n        return _this.url.indexOf(o) > -1;\n      });\n    }\n  },\n  methods: {\n    openModal: function openModal() {\n      var _this2 = this;\n      this.visible = true;\n      this.loading = false;\n      if (this.type == 'menu') this.getMenuSelectorList();\n      this.$nextTick(function () {\n        _this2.$refs.dataForm && _this2.$refs.dataForm.resetFields();\n      });\n    },\n    getMenuSelectorList: function getMenuSelectorList() {\n      var _this3 = this;\n      (0, _menu.getMenuSelector)({\n        category: this.data.category\n      }, '', this.data.systemId).then(function (res) {\n        _this3.treeOptions = [{\n          fullName: '顶级节点',\n          hasChildren: true,\n          id: '-1',\n          children: res.data.list\n        }];\n      });\n    },\n    handleSubmit: function handleSubmit() {\n      var _this4 = this;\n      this.loading = true;\n      this.$refs['dataForm'].validate(function (valid) {\n        if (!valid) return _this4.loading = false;\n        if (!_this4.url && !_this4.importType) return _this4.loading = false;\n        var formData = new FormData();\n        formData.append('file', _this4.dataForm.fileList[0]);\n        formData.append('type', _this4.dataForm.type);\n        for (var _i = 0, _Object$entries = Object.entries(_this4.data || {}); _i < _Object$entries.length; _i++) {\n          var _Object$entries$_i = (0, _slicedToArray2.default)(_Object$entries[_i], 2),\n            key = _Object$entries$_i[0],\n            value = _Object$entries$_i[1];\n          formData.append(key, value);\n        }\n        if (_this4.type == 'menu') formData.append('parentId', _this4.dataForm.parentId);\n        var formMethod = _this4.importType === 'dataReport' ? _dataReport.importData : _common.upload;\n        formMethod(_this4.url, formData).then(function (res) {\n          _this4.$message.success(res.msg);\n          _this4.uploadSuccess();\n          _this4.loading = false;\n          _this4.visible = false;\n        }).catch(function () {\n          _this4.loading = false;\n        });\n      });\n    },\n    uploadSuccess: function uploadSuccess() {\n      this.$emit('on-success');\n    },\n    handleRemove: function handleRemove() {\n      this.dataForm.fileList = [];\n    },\n    beforeUpload: function beforeUpload(file) {\n      var isAccept = this.checkAccept(file);\n      if (!isAccept) {\n        this.$message.error(\"\\u8BF7\\u9009\\u62E9\".concat(this.accept, \"\\u7C7B\\u578B\\u7684\\u6587\\u4EF6\"));\n        return isAccept;\n      }\n      this.dataForm.fileList = [file];\n      return false;\n    },\n    checkAccept: function checkAccept(file) {\n      if (!this.accept || this.accept === '*') return true;\n      var extension = file.name.substring(file.name.lastIndexOf(\".\"));\n      if (this.accept.indexOf(extension) > -1) return true;\n      return false;\n    }\n  }\n};",null]}