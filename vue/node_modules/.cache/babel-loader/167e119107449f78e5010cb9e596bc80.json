{"remainingRequest":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js??vue-loader-options!/Users/交安/gas/vue/gas-web/src/components/SuperQuery/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/交安/gas/vue/gas-web/src/components/SuperQuery/index.vue","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/babel.config.js","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime@7.24.5@@babel/runtime/helpers/interopRequireDefault.js\");\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\nrequire(\"core-js/modules/web.dom.iterable\");\nrequire(\"core-js/modules/es6.object.keys\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _typeof2 = _interopRequireDefault(require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime-corejs2@7.24.5@@babel/runtime-corejs2/helpers/typeof.js\"));\nrequire(\"core-js/modules/es7.array.includes\");\nrequire(\"core-js/modules/es6.string.includes\");\nvar _defineProperty2 = _interopRequireDefault(require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime-corejs2@7.24.5@@babel/runtime-corejs2/helpers/defineProperty.js\"));\nvar _advancedQuery = require(\"@/api/system/advancedQuery\");\nvar _condition = _interopRequireDefault(require(\"@/components/ColumnDesign/condition\"));\nvar _utils = require(\"@/utils\");\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; } //\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar condition = [{\n  logic: \"and\",\n  groups: [{\n    fieldValue: '',\n    field: '',\n    symbol: '',\n    jnpfKey: '',\n    cellKey: +new Date()\n  }]\n}];\nvar _default2 = exports.default = {\n  components: {\n    Condition: _condition.default\n  },\n  props: {\n    columnOptions: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    }\n  },\n  data: function data() {\n    return {\n      visible: false,\n      addPlanVisible: false,\n      loading: false,\n      btnLoading: false,\n      saveBtnLoading: false,\n      conditionList: (0, _utils.deepClone)(condition),\n      staging: {},\n      key2: +new Date(),\n      planList: [],\n      fieldOptions: [],\n      dataForm: {\n        fullName: ''\n      },\n      dataRule: {\n        fullName: [{\n          required: true,\n          message: '请输入保存的方案名称',\n          trigger: 'blur'\n        }]\n      },\n      matchLogic: 'and'\n    };\n  },\n  computed: {\n    currMenuId: function currMenuId() {\n      return this.$route.meta.modelId || '';\n    }\n  },\n  methods: {\n    init: function init() {\n      var _this = this;\n      this.visible = true;\n      this.loading = true;\n      var componentList = JSON.parse(JSON.stringify(this.columnOptions));\n      this.fieldOptions = componentList;\n      this.getAdvancedQueryList();\n      this.$nextTick(function () {\n        _this.loading = false;\n      });\n    },\n    close: function close() {\n      this.conditionList = this.staging && this.staging.conditionList || (0, _utils.deepClone)(condition);\n      this.matchLogic = this.staging && this.staging.matchLogic || 'and';\n      this.visible = false;\n    },\n    getAdvancedQueryList: function getAdvancedQueryList() {\n      var _this2 = this;\n      if (!this.currMenuId) return;\n      (0, _advancedQuery.getAdvancedQueryList)(this.currMenuId).then(function (res) {\n        _this2.planList = res.data.list;\n      });\n    },\n    addCondition: function addCondition() {\n      var item = {\n        logic: \"and\",\n        groups: [{\n          field: '',\n          symbol: '',\n          jnpfKey: '',\n          fieldValueType: 2,\n          fieldValue: undefined,\n          fieldValueJnpfKey: '',\n          cellKey: +new Date()\n        }]\n      };\n      this.conditionList.push(item);\n    },\n    delPlan: function delPlan(id, i) {\n      var _this3 = this;\n      (0, _advancedQuery.Delete)(id).then(function (res) {\n        _this3.$message({\n          type: 'success',\n          message: res.msg,\n          duration: 1500,\n          onClose: function onClose() {\n            _this3.planList.splice(i, 1);\n          }\n        });\n      });\n    },\n    selectPlan: function selectPlan(item) {\n      this.conditionList = item.conditionJson ? JSON.parse(item.conditionJson) : [];\n      this.matchLogic = item.matchLogic;\n      this.key2 = +new Date();\n      this.$refs.planPopper.doClose();\n    },\n    addPlan: function addPlan() {\n      var _this4 = this;\n      if (!this.exist()) return;\n      this.addPlanVisible = true;\n      this.$nextTick(function () {\n        _this4.$refs['dataForm'].resetFields();\n      });\n    },\n    savePlan: function savePlan() {\n      var _this5 = this;\n      this.$refs['dataForm'].validate(function (valid) {\n        if (valid) {\n          var boo = _this5.planList.some(function (o) {\n            return o.fullName === _this5.dataForm.fullName;\n          });\n          if (!boo) return _this5.submit();\n          var list = _this5.planList.filter(function (o) {\n            return o.fullName === _this5.dataForm.fullName;\n          });\n          _this5.$confirm(\"\".concat(list[0].fullName, \"\\u5DF2\\u5B58\\u5728, \\u662F\\u5426\\u8986\\u76D6\\u65B9\\u6848?\"), '', {\n            type: 'warning'\n          }).then(function () {\n            _this5.submit(list[0].id);\n          }).catch(function () {});\n        }\n      });\n    },\n    submit: function submit(id) {\n      var _this6 = this;\n      this.saveBtnLoading = true;\n      var query = _objectSpread(_objectSpread({\n        id: id || ''\n      }, this.dataForm), {}, {\n        matchLogic: this.matchLogic,\n        moduleId: this.currMenuId,\n        conditionJson: JSON.stringify(this.conditionList)\n      });\n      var formMethod = query.id ? _advancedQuery.Update : _advancedQuery.Create;\n      formMethod(query).then(function (res) {\n        _this6.getAdvancedQueryList();\n        _this6.addPlanVisible = false;\n        _this6.saveBtnLoading = false;\n        _this6.$message({\n          message: res.msg,\n          type: 'success',\n          duration: 1500\n        });\n      }).catch(function () {\n        _this6.saveBtnLoading = false;\n      });\n    },\n    getDataType: function getDataType(jnpfKey) {\n      if (!jnpfKey) return '';\n      if (['inputNumber', 'datePicker', 'rate', 'slider'].includes(jnpfKey)) {\n        return 'number';\n      } else if (['uploadFile', 'uploadImg', 'cascader', 'organizeSelect', 'areaSelect'].includes(jnpfKey)) {\n        return 'array';\n      }\n      return '';\n    },\n    exist: function exist(type) {\n      var mes = type == 'query' ? '查询' : '保存';\n      var item = this.$refs.base && this.$refs.base.getData() || '';\n      if (type == 'query' && !item) return true;\n      if (!item) return this.$message.warning(\"\\u8BF7\\u6DFB\\u52A0\".concat(mes, \"\\u6761\\u4EF6\"));\n      this.conditionList = item.conditionList;\n      this.matchLogic = item.matchLogic;\n      var isOk = true;\n      for (var i = 0; i < this.conditionList.length; i++) {\n        var e = this.conditionList[i];\n        for (var j = 0; j < e.groups.length; j++) {\n          var child = e.groups[j];\n          if (!child.field) {\n            this.$message.warning(\"\".concat(mes, \"\\u5B57\\u6BB5\\u4E0D\\u80FD\\u4E3A\\u7A7A\"));\n            isOk = false;\n            return;\n          }\n          if (!child.symbol) {\n            this.$message.warning(\"\".concat(mes, \"\\u7B26\\u53F7\\u4E0D\\u80FD\\u4E3A\\u7A7A\"));\n            isOk = false;\n            return;\n          }\n          if (!['null', 'notNull'].includes(child.symbol) && !['switch'].includes(child.jnpfKey) && (!child.fieldValue && child.fieldValue !== 0 || (0, _typeof2.default)(child.fieldValue) === \"object\" && child.fieldValue.length == 0 || this.jnpf.isEmpty(child.fieldValue))) {\n            this.$message.warning(\"\\u6570\\u636E\\u503C\\u4E0D\\u80FD\\u4E3A\\u7A7A\");\n            isOk = false;\n            return;\n          }\n        }\n      }\n      return isOk;\n    },\n    query: function query() {\n      if (!this.exist('query')) return;\n      var query = {\n        matchLogic: this.matchLogic,\n        conditionList: this.conditionList\n      };\n      this.staging = JSON.parse(JSON.stringify(query));\n      query = JSON.stringify(query);\n      if (!this.conditionList.length) query = \"\";\n      this.$emit('superQuery', query);\n      this.visible = false;\n    }\n  }\n};",null]}