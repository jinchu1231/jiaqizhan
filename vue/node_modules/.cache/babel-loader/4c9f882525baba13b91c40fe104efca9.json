{"remainingRequest":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!/Users/交安/gas/vue/gas-web/src/views/workFlow/workFlowForm/mixin.js","dependencies":[{"path":"/Users/交安/gas/vue/gas-web/src/views/workFlow/workFlowForm/mixin.js","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/babel.config.js","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime@7.24.5@@babel/runtime/helpers/interopRequireDefault.js\");\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\nrequire(\"core-js/modules/web.dom.iterable\");\nrequire(\"core-js/modules/es6.object.keys\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es6.regexp.split\");\nrequire(\"core-js/modules/es6.function.name\");\nrequire(\"core-js/modules/es6.string.includes\");\nrequire(\"core-js/modules/es7.array.includes\");\nvar _defineProperty2 = _interopRequireDefault(require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime-corejs2@7.24.5@@babel/runtime-corejs2/helpers/defineProperty.js\"));\nvar _vuex = require(\"vuex\");\nvar _billRule = require(\"@/api/system/billRule\");\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nvar includeList = ['crmOrder', 'salesOrder', 'leaveApply'];\nvar _default = exports.default = {\n  props: ['config'],\n  computed: _objectSpread(_objectSpread({}, (0, _vuex.mapGetters)(['userInfo'])), {}, {\n    formOperates: function formOperates() {\n      return this.setting.formOperates;\n    }\n  }),\n  data: function data() {\n    return {\n      flowUrgentOptions: [{\n        value: 1,\n        label: '普通'\n      }, {\n        value: 2,\n        label: '重要'\n      }, {\n        value: 3,\n        label: '紧急'\n      }],\n      fileList: [],\n      setting: {},\n      eventType: '',\n      loading: false,\n      tableRequiredData: {},\n      formRef: 'dataForm'\n    };\n  },\n  mounted: function mounted() {\n    this.init(this.config);\n  },\n  methods: {\n    init: function init(data) {\n      var _this = this;\n      this.dataForm.id = data.id || '';\n      if (this.dataForm.id) this.loading = true;\n      this.setting = data;\n      this.updateDataRule();\n      this.$nextTick(function () {\n        _this.$refs[_this.formRef].resetFields();\n        if (_this.beforeInit && typeof _this.beforeInit === \"function\") _this.beforeInit();\n        if (data.id) {\n          var dataForm = data.draftData || data.formData;\n          if (_this.selfGetInfo && typeof _this.selfGetInfo === \"function\") {\n            _this.selfGetInfo(dataForm);\n          } else {\n            _this.dataForm = dataForm;\n          }\n          if (includeList.includes(data.formEnCode)) {\n            _this.fileList = JSON.parse(_this.dataForm.fileJson);\n          }\n          _this.loading = false;\n          _this.$emit('setPageLoad');\n          return;\n        } else {\n          _this.dataForm.flowId = data.flowId;\n          if (_this.selfInit) _this.selfInit(data);\n          if (data.leftTreeActiveInfo) _this.dataForm = _objectSpread(_objectSpread({}, _this.dataForm), data.leftTreeActiveInfo);\n          if (!_this.billEnCode) return _this.$emit('setPageLoad');\n          (0, _billRule.BillNumber)(_this.billEnCode).then(function (res) {\n            if (_this.billEnCode === 'OrderNumber') {\n              _this.dataForm.orderCode = res.data;\n            } else {\n              _this.dataForm.billNo = res.data;\n            }\n            _this.$emit('setPageLoad');\n          });\n        }\n      });\n    },\n    getPaymentMethodOptions: function getPaymentMethodOptions() {\n      var _this2 = this;\n      this.$store.dispatch('base/getDictionaryData', {\n        sort: 'WFSettlementMethod'\n      }).then(function (res) {\n        _this2.paymentMethodOptions = res;\n      });\n    },\n    dataFormSubmit: function dataFormSubmit(eventType, flowUrgent) {\n      var _this3 = this;\n      this.eventType = eventType;\n      this.$refs[this.formRef].validate(function (valid) {\n        if (valid) {\n          if (_this3.exist && !_this3.exist()) return;\n          if (_this3.selfExist && !_this3.selfExist()) return;\n          var dataForm = {};\n          if (_this3.beforeSubmit && typeof _this3.beforeSubmit === \"function\") {\n            dataForm = _this3.beforeSubmit();\n          } else {\n            dataForm = _this3.dataForm;\n          }\n          if (includeList.includes(_this3.setting.formEnCode)) {\n            dataForm.fileJson = JSON.stringify(_this3.fileList);\n          }\n          if (eventType === 'save' || eventType === 'submit') {\n            if (_this3.selfSubmit && typeof _this3.selfSubmit === \"function\") {\n              _this3.selfSubmit(dataForm, flowUrgent);\n              return;\n            }\n          }\n          _this3.$emit('eventReceiver', {\n            formData: dataForm\n          }, eventType);\n        }\n      });\n    },\n    updateDataRule: function updateDataRule() {\n      if (!this.setting.formOperates || !this.setting.formOperates.length) return this.dataRule = {};\n      var newRules = {};\n      for (var i = 0; i < this.setting.formOperates.length; i++) {\n        var item = this.setting.formOperates[i];\n        if (!item.id.includes('-')) {\n          var newRulesItem = {\n            required: item.required || false,\n            message: item.name + '不能为空',\n            trigger: item.trigger || 'blur'\n          };\n          if (!this.dataRule.hasOwnProperty(item.id)) {\n            if (item.required) this.$set(newRules, item.id, [newRulesItem]);\n          } else {\n            var withoutRequiredItem = true;\n            for (var _i = 0; _i < this.dataRule[item.id].length; _i++) {\n              if (this.dataRule[item.id][_i].hasOwnProperty('required')) {\n                this.dataRule[item.id][_i].required = item.required || false;\n                withoutRequiredItem = false;\n              }\n            }\n            if (withoutRequiredItem && item.required) this.dataRule[item.id].push(newRulesItem);\n          }\n        } else {\n          var key = item.id.split('-')[0];\n          var newId = item.id.split('-')[1];\n          var newItem = _objectSpread(_objectSpread({}, item), {}, {\n            id: newId\n          });\n          if (!this.tableRequiredData.hasOwnProperty(key)) {\n            this.$set(this.tableRequiredData, key, [newItem]);\n          } else {\n            this.tableRequiredData[key].push(newItem);\n          }\n        }\n      }\n      this.dataRule = _objectSpread(_objectSpread({}, this.dataRule), newRules);\n    },\n    exist: function exist() {\n      var _this4 = this;\n      var isOk = true;\n      for (var key in this.tableRequiredData) {\n        if (this.dataForm[key] && Array.isArray(this.dataForm[key])) {\n          for (var i = 0; i < this.dataForm[key].length; i++) {\n            var item = this.dataForm[key][i];\n            var _loop = function _loop(id) {\n                var arr = _this4.tableRequiredData[key].filter(function (o) {\n                  return o.id === id;\n                }) || [];\n                if (!arr.length) return 0; // continue inner\n                if (arr[0].required) {\n                  var msg = \"\".concat(arr[0].name, \"\\u4E0D\\u80FD\\u4E3A\\u7A7A\");\n                  var boo = true;\n                  if (arr[0].dataType === 'array') {\n                    boo = !_this4.jnpf.isEmptyArray(item[id]);\n                  } else {\n                    boo = !_this4.jnpf.isEmpty(item[id]);\n                  }\n                  if (!boo) {\n                    _this4.$message({\n                      message: msg,\n                      type: 'error',\n                      duration: 1000\n                    });\n                    isOk = false;\n                    return 1; // break\n                  }\n                }\n              },\n              _ret;\n            inner: for (var id in item) {\n              _ret = _loop(id);\n              if (_ret === 0) continue inner;\n              if (_ret === 1) break;\n            }\n          }\n        }\n      }\n      return isOk;\n    },\n    judgeRequired: function judgeRequired(id) {\n      if (!this.formOperates || !this.formOperates.length) return false;\n      var arr = this.formOperates.filter(function (o) {\n        return o.id === id;\n      }) || [];\n      if (!arr.length) return false;\n      var item = arr[0];\n      return item.required;\n    },\n    judgeShow: function judgeShow(id) {\n      if (this.setting.opType == 4) return true;\n      if (!this.setting.formOperates || !this.setting.formOperates.length) return true;\n      var arr = this.setting.formOperates.filter(function (o) {\n        return o.id === id;\n      }) || [];\n      if (!arr.length) return true;\n      var item = arr[0];\n      return item.read;\n    },\n    judgeWrite: function judgeWrite(id) {\n      if (this.setting.readonly) return true;\n      if (!this.setting.formOperates || !this.setting.formOperates.length) return false;\n      var arr = this.setting.formOperates.filter(function (o) {\n        return o.id === id;\n      }) || [];\n      if (!arr.length) return true;\n      var item = arr[0];\n      return !item.write;\n    }\n  }\n};",null]}