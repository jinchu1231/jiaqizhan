{"remainingRequest":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js!/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js??vue-loader-options!/Users/交安/gas/vue/gas-web/src/views/workFlow/workFlowForm/dynamicForm/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/交安/gas/vue/gas-web/src/views/workFlow/workFlowForm/dynamicForm/index.vue","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/babel.config.js","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime@7.24.5@@babel/runtime/helpers/interopRequireDefault.js\");\nrequire(\"core-js/modules/es7.object.get-own-property-descriptors\");\nrequire(\"core-js/modules/web.dom.iterable\");\nrequire(\"core-js/modules/es6.object.keys\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"core-js/modules/es7.array.includes\");\nrequire(\"core-js/modules/es6.string.includes\");\nvar _defineProperty2 = _interopRequireDefault(require(\"/Users/\\u4EA4\\u5B89/gas/vue/gas-web/node_modules/_@babel_runtime-corejs2@7.24.5@@babel/runtime-corejs2/helpers/defineProperty.js\"));\nvar _Parser = _interopRequireDefault(require(\"@/components/Generator/parser/Parser\"));\nvar _vuex = require(\"vuex\");\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; } //\n//\n//\n//\n//\n//\nvar _default = exports.default = {\n  props: ['config'],\n  components: {\n    Parser: _Parser.default\n  },\n  data: function data() {\n    return {\n      setting: {},\n      formData: {},\n      loading: true,\n      eventType: '',\n      flowUrgent: 1,\n      key: +new Date(),\n      formConf: {},\n      isCustomCopy: false,\n      isAdd: false,\n      dataForm: {\n        id: '',\n        formData: {},\n        flowId: ''\n      }\n    };\n  },\n  computed: _objectSpread({}, (0, _vuex.mapGetters)(['userInfo'])),\n  mounted: function mounted() {\n    this.init(this.config);\n  },\n  methods: {\n    init: function init(data) {\n      var _this = this;\n      this.setting = data;\n      this.formConf = data.formConf ? JSON.parse(data.formConf) : {};\n      this.formData = {};\n      this.dataForm.id = data.id || '';\n      this.isCustomCopy = this.setting.flowTemplateJson && this.setting.flowTemplateJson.properties && this.setting.flowTemplateJson.properties.isCustomCopy;\n      this.loading = true;\n      this.$nextTick(function () {\n        var extra = {};\n        if (data.id) {\n          _this.isAdd = false;\n          extra = {\n            modelId: data.flowId,\n            id: data.id,\n            type: data.type,\n            flowId: data.flowId,\n            processId: data.id,\n            taskId: data.taskId,\n            opType: data.opType\n          };\n          var formData = data.draftData || data.formData;\n          _this.formData = _objectSpread(_objectSpread({}, formData), {}, {\n            flowId: data.flowId\n          });\n        } else {\n          _this.isAdd = true;\n          if (data.getLeftTreeActiveInfo) _this.formData = _objectSpread({}, data.getLeftTreeActiveInfo);\n        }\n        _this.$store.commit('generator/SET_DYNAMIC_MODEL_EXTRA', extra);\n        _this.fillFormData(_this.formConf, _this.formData);\n        _this.$nextTick(function () {\n          _this.loading = false;\n          _this.$emit('setPageLoad');\n        });\n        _this.dataForm.flowId = data.flowId;\n        _this.key = +new Date();\n      });\n    },\n    fillFormData: function fillFormData(form, data) {\n      var _this2 = this;\n      form.disabled = this.setting.readonly;\n      var loop = function loop(list, parent) {\n        var _loop = function _loop() {\n          var item = list[i];\n          if (item.__vModel__) {\n            var val = data.hasOwnProperty(item.__vModel__) ? data[item.__vModel__] : _this2.isAdd ? item.__config__.defaultValue : undefined;\n            if (!item.__config__.isSubTable) item.__config__.defaultValue = val;\n            if ((_this2.isAdd || !_this2.isAdd && item.__config__.isSubTable) && item.__config__.defaultCurrent) {\n              if (item.__config__.jnpfKey === 'datePicker') {\n                var format = item.format;\n                var dateStr = _this2.jnpf.toDate(new Date().getTime(), format);\n                var time = format === 'yyyy' ? '-01-01 00:00:00' : format === 'yyyy-MM' ? '-01 00:00:00' : format === 'yyyy-MM-dd' ? ' 00:00:00' : '';\n                item.__config__.defaultValue = new Date(dateStr + time).getTime();\n              }\n              if (item.__config__.jnpfKey === 'timePicker') {\n                item.__config__.defaultValue = _this2.jnpf.toDate(new Date(), item.format);\n              }\n              if (item.__config__.jnpfKey === 'organizeSelect' && _this2.userInfo.organizeIdList instanceof Array && _this2.userInfo.organizeIdList.length > 0) {\n                item.__config__.defaultValue = item.multiple == true ? [_this2.userInfo.organizeIdList] : _this2.userInfo.organizeIdList;\n              }\n              if (item.__config__.jnpfKey === 'depSelect' && _this2.userInfo.departmentId) {\n                item.__config__.defaultValue = item.multiple ? [_this2.userInfo.departmentId] : _this2.userInfo.departmentId;\n              }\n              if (item.__config__.jnpfKey === 'posSelect' && _this2.userInfo.positionIds instanceof Array && _this2.userInfo.positionIds.length > 0) {\n                item.__config__.defaultValue = item.multiple ? _this2.userInfo.positionIds.map(function (o) {\n                  return o.id;\n                }) : _this2.userInfo.positionIds[0].id;\n              }\n              if (item.__config__.jnpfKey === 'roleSelect' && _this2.userInfo.roleIds instanceof Array && _this2.userInfo.roleIds.length > 0) {\n                item.__config__.defaultValue = item.multiple ? _this2.userInfo.roleIds : _this2.userInfo.roleIds[0];\n              }\n              if (item.__config__.jnpfKey === 'groupSelect' && _this2.userInfo.groupIds instanceof Array && _this2.userInfo.groupIds.length > 0) {\n                item.__config__.defaultValue = item.multiple ? _this2.userInfo.groupIds : _this2.userInfo.groupIds[0];\n              }\n              if (['userSelect'].includes(item.__config__.jnpfKey) && _this2.userInfo.userId) {\n                item.__config__.defaultValue = item.multiple ? [_this2.userInfo.userId] : _this2.userInfo.userId;\n              }\n              if (item.__config__.jnpfKey === 'usersSelect' && _this2.userInfo.userId) {\n                item.__config__.defaultValue = item.multiple ? [_this2.userInfo.userId + '--user'] : _this2.userInfo.userId + '--user';\n              }\n              if (item.__config__.jnpfKey === 'sign' && _this2.userInfo.signImg) {\n                item.__config__.defaultValue = _this2.userInfo.signImg;\n              }\n            }\n            var noShow = item.__config__.noShow || false,\n              isDisabled = item.disabled || false,\n              required = item.__config__.required || false;\n            if (_this2.setting.formOperates && _this2.setting.formOperates.length) {\n              var id = item.__config__.isSubTable ? parent.__vModel__ + '-' + item.__vModel__ : item.__vModel__;\n              var arr = _this2.setting.formOperates.filter(function (o) {\n                return o.id === id;\n              }) || [];\n              if (arr.length) {\n                var obj = arr[0];\n                noShow = !obj.read;\n                isDisabled = !obj.write;\n                required = obj.required ? obj.required : item.__config__.required;\n              }\n            }\n            if (_this2.setting.readonly) isDisabled = true;\n            _this2.$set(item, 'disabled', isDisabled);\n            _this2.$set(item.__config__, 'noShow', noShow);\n            _this2.$set(item.__config__, 'required', required || false);\n          }\n          if (item.__config__ && item.__config__.children && Array.isArray(item.__config__.children)) {\n            loop(item.__config__.children, item);\n          }\n        };\n        for (var i = 0; i < list.length; i++) {\n          _loop();\n        }\n      };\n      loop(form.fields);\n      form.formData = data;\n    },\n    submitForm: function submitForm(data, callback) {\n      if (!data) return;\n      var formData = _objectSpread(_objectSpread({}, this.formData), data);\n      this.dataForm.formData = formData;\n      if (callback && typeof callback === \"function\") callback();\n      this.$emit('eventReceiver', this.dataForm, this.eventType);\n    },\n    dataFormSubmit: function dataFormSubmit(eventType, flowUrgent) {\n      if (this.setting.isPreview) return this.$message({\n        message: '功能预览不支持数据保存',\n        type: 'warning'\n      });\n      this.eventType = eventType;\n      this.flowUrgent = flowUrgent;\n      this.$refs.dynamicForm && this.$refs.dynamicForm.submitForm();\n    }\n  }\n};",null]}