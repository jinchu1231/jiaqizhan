{"remainingRequest":"/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js??vue-loader-options!/Users/交安/gas/vue/gas-web/src/components/Generator/index/RightComponents/RTable/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/交安/gas/vue/gas-web/src/components/Generator/index/RightComponents/RTable/index.vue","mtime":1706684850000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_babel-loader@8.3.0@babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/交安/gas/vue/gas-web/node_modules/_vue-loader@15.11.1@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Form from './AddTableForm'\nimport draggable from 'vuedraggable'\nimport ComplexHeader from '@/components/Generator/components/ComplexHeader'\nimport {\n  inputComponents, selectComponents\n} from '@/components/Generator/generator/config'\nimport { noTableAllowList, calculateItem } from '@/components/Generator/generator/comConfig'\nconst defaultAddTableConf = {\n  popupTitle: '选择数据',\n  popupType: 'dialog',\n  popupWidth: '800px',\n  dataSource: 'dynamic',\n  interfaceId: '',\n  interfaceName: '',\n  templateJson: [],\n  hasPage: true,\n  pageSize: 20,\n  columnOptions: [],\n  relationOptions: [],\n}\nconst defaultColumnBtnsList = [\n  { value: 'copy', label: '复制', show: true, btnType: 'primary', btnIcon: 'icon-ym icon-ym-btn-edit' },\n  { value: 'remove', label: '删除', show: true, btnType: 'danger', btnIcon: 'icon-ym icon-ym-btn-clearn', showConfirm: true },\n];\nconst defaultFooterBtnsList = [\n  { value: 'add', label: '添加', show: true, btnType: 'primary', btnIcon: 'icon-ym icon-ym-btn-add' },\n  { value: 'batchRemove', label: '批量删除', show: true, btnType: 'danger', btnIcon: 'icon-ym icon-ym-btn-clearn', showConfirm: true },\n];\nexport default {\n  props: ['activeData', 'showType', 'modelType'],\n  components: { Form, ComplexHeader, draggable },\n  data() {\n    return {\n      formVisible: false,\n      thousandsOptions: [],\n      complexHeaderVisible: false,\n      defaultAddTableConf,\n      activeRowIndex: 0,\n      activeRowType: '',\n    }\n  },\n  computed: {\n    getBaseOptions() {\n      let noTableList = [...noTableAllowList, 'table']\n      return inputComponents.filter(o => !noTableList.includes(o.__config__ && o.__config__.jnpfKey))\n    },\n    getSeniorOptions() {\n      let noTableList = [...noTableAllowList, 'table']\n      let list = selectComponents.filter(o => !noTableList.includes(o.__config__ && o.__config__.jnpfKey))\n      if (this.modelType == 1 || this.modelType == 6) list = [...list, calculateItem]\n      return list\n    }\n  },\n  mounted() {\n    if (!this.activeData.columnBtnsList || !this.activeData.columnBtnsList.length) this.activeData.columnBtnsList = JSON.parse(JSON.stringify(defaultColumnBtnsList))\n    if (!this.activeData.footerBtnsList || !this.activeData.footerBtnsList.length) this.activeData.footerBtnsList = JSON.parse(JSON.stringify(defaultFooterBtnsList))\n  },\n  methods: {\n    editConf(item, index, type) {\n      this.activeRowIndex = index\n      this.activeRowType = type\n      let defaultAddTableConf = {}\n      if (!item) {\n        item = {}\n        defaultAddTableConf = JSON.parse(JSON.stringify(this.defaultAddTableConf))\n        item.value = 'btn-' + this.jnpf.idGenerator()\n        item.label = ''\n        item.show = true\n        item.btnIcon = ''\n        item.btnType = ''\n      } else if (!['copy', 'remove', 'add', 'batchRemove'].includes(item.value)) {\n        defaultAddTableConf = JSON.parse(JSON.stringify(item.actionConfig))\n      }\n      this.formVisible = true\n      this.$nextTick(() => {\n        this.$refs.Form.init(item, defaultAddTableConf, this.activeData.__config__.children)\n      })\n    },\n    addBtnChange(e) {\n      if (!e) {\n        this.activeData.addType = e ? 1 : 0\n        this.activeData.addTableConf = JSON.parse(JSON.stringify(defaultAddTableConf))\n      }\n    },\n    setAction(e) {\n      if (!e) this.activeData.addTableConf = JSON.parse(JSON.stringify(defaultAddTableConf))\n    },\n    closeForm(val) {\n      if (val) this.activeData.__config__.complexHeaderList = val\n      this.complexHeaderVisible = false\n    },\n    addComplexHeader() {\n      this.complexHeaderVisible = true\n      let list = this.activeData.__config__.children.filter(o => o.__vModel__ && o.__config__.tableFixed === 'none')\n      let complexHeaderList = JSON.parse(JSON.stringify(this.activeData.__config__.complexHeaderList))\n      complexHeaderList = this.updateComplexHeader(complexHeaderList, list) || []\n      this.$nextTick(() => {\n        this.$refs.ComplexHeader.init(complexHeaderList, list)\n      })\n    },\n    updateComplexHeader(complexHeaderList, list) {\n      if (!complexHeaderList.length) return [];\n      for (let i = 0; i < complexHeaderList.length; i++) {\n        const e = complexHeaderList[i];\n        e.childColumns = e.childColumns.filter(o => list.some(item => item.__vModel__ == o));\n      }\n      return complexHeaderList\n    },\n    updateConf(item, actionConfig) {\n      if (['copy', 'remove', 'add', 'batchRemove'].includes(item.value)) return this.$set(this.activeData[this.activeRowType], this.activeRowIndex, item)\n      if (this.activeRowIndex >= 0) return this.$set(this.activeData[this.activeRowType], this.activeRowIndex, { ...item, actionConfig })\n      this.activeData[this.activeRowType].push({ ...item, actionConfig })\n    },\n    addHandle(item) {\n      if (this.$store.getters.hasTable && !this.activeData.__config__.tableName) return this.$message.warning('子表请先关联数据表')\n      item.__config__.isSubTable = true\n      item.__config__.parentVModel = this.activeData.__vModel__\n      if (this.$store.getters.hasTable) item.__config__.relationTable = this.activeData.__config__.tableName\n      this.$emit('addComponent', item, this.activeData.__config__.children)\n    },\n  }\n}\n",null]}